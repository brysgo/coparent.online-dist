(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[850],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(5155),r=s(2115),i=s(4624),n=s(2085),l=s(9434);let o=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:c=!1,...d}=e,u=c?i.DX:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:r,size:n,className:s})),ref:t,...d})});c.displayName="Button"},1851:(e,t,s)=>{Promise.resolve().then(s.bind(s,5204))},2085:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(2596);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=a.$,n=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return i(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:n,defaultVariants:l}=t,o=Object.keys(n).map(e=>{let t=null==s?void 0:s[e],a=null==l?void 0:l[e];if(null===t)return null;let i=r(t)||r(a);return n[e][i]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return i(e,o,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...l,...c}[t]):({...l,...c})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",s),ref:t,...n})});n.displayName="Input"},4624:(e,t,s)=>{"use strict";s.d(t,{DX:()=>n});var a=s(2115);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var i=s(5155),n=function(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:s,...i}=e;if(a.isValidElement(s)){var n;let e,l,o=(n=s,(l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(l=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),c=function(e,t){let s={...t};for(let a in t){let r=e[a],i=t[a];/^on[A-Z]/.test(a)?r&&i?s[a]=(...e)=>{let t=i(...e);return r(...e),t}:r&&(s[a]=r):"style"===a?s[a]={...r,...i}:"className"===a&&(s[a]=[r,i].filter(Boolean).join(" "))}return{...e,...s}}(i,s.props);return s.type!==a.Fragment&&(c.ref=t?function(...e){return t=>{let s=!1,a=e.map(e=>{let a=r(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():r(e[t],null)}}}}(t,o):o),a.cloneElement(s,c)}return a.Children.count(s)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=a.forwardRef((e,s)=>{let{children:r,...n}=e,l=a.Children.toArray(r),c=l.find(o);if(c){let e=c.props.children,r=l.map(t=>t!==c?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...n,ref:s,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,i.jsx)(t,{...n,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}("Slot"),l=Symbol("radix.slottable");function o(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>n});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("label",{ref:t,className:(0,i.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70","text-gray-700",s),...r})});n.displayName="Label"},5204:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(5155),r=s(2115),i=s(3715),n=s(5695);class l{async createSituation(e){let t=this.generateId(),s=new Date,a=this.getTemplate(e.type),r=this.determineAssignment(e,a),i=this.calculateDeadline(e,a),n={...e,id:t,createdAt:s,assignedTo:r,deadline:i,updates:[],escalations:[],priority:e.priority||(null==a?void 0:a.defaultPriority)||"medium",status:e.status||"created"};return this.situations.set(t,n),await this.addUpdate(t,{userId:n.createdBy,type:"status_change",content:"Situation created: ".concat(n.title),metadata:{status:"created"}}),await this.notifyAssignedParties(n),n}async updateSituation(e,t){let s=this.situations.get(e);if(!s)throw Error("Situation ".concat(e," not found"));let a={...s,...t};return this.situations.set(e,a),t.status&&t.status!==s.status&&await this.addUpdate(e,{userId:"system",type:"status_change",content:"Status changed from ".concat(s.status," to ").concat(t.status),metadata:{oldStatus:s.status,newStatus:t.status}}),a}async addUpdate(e,t){let s=this.situations.get(e);if(!s)throw Error("Situation ".concat(e," not found"));let a={id:this.generateId(),situationId:e,timestamp:new Date,...t};s.updates.push(a),this.situations.set(e,s)}async resolveSituation(e,t,s){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));await this.updateSituation(e,{status:"resolved",resolvedAt:new Date}),await this.addUpdate(e,{userId:"system",type:"status_change",content:"Situation resolved: ".concat(t),metadata:{resolution:t,...s}}),a.gamificationImpact&&await this.applyGamificationImpact(a)}async escalateSituation(e,t){let s=this.situations.get(e);if(!s)throw Error("Situation ".concat(e," not found"));let a=s.escalations.length+1,r={id:this.generateId(),situationId:e,level:a,reason:t,triggeredAt:new Date,triggeredBy:"user",actions:this.getEscalationActions(s,a),resolved:!1};s.escalations.push(r),await this.updateSituation(e,{status:"escalated",priority:this.increasePriority(s.priority)}),await this.addUpdate(e,{userId:"system",type:"escalation",content:"Situation escalated (Level ".concat(a,"): ").concat(t),metadata:{escalationLevel:a,reason:t}}),await this.executeEscalationActions(r)}async getSituations(e){let t=Array.from(this.situations.values());return e.relationshipId&&(t=t.filter(t=>t.relationshipId===e.relationshipId)),e.status&&(t=t.filter(t=>e.status.includes(t.status))),e.type&&(t=t.filter(t=>e.type.includes(t.type))),e.assignedTo&&(t=t.filter(t=>t.assignedTo.includes(e.assignedTo))),e.priority&&(t=t.filter(t=>e.priority.includes(t.priority))),t.sort((e,t)=>{let s={urgent:4,high:3,medium:2,low:1},a=s[e.priority],r=s[t.priority];return a!==r?r-a:t.createdAt.getTime()-e.createdAt.getTime()})}getSituation(e){return this.situations.get(e)}getOverdueSituations(){let e=new Date;return Array.from(this.situations.values()).filter(t=>t.deadline&&t.deadline<e&&!["resolved","cancelled"].includes(t.status))}getSituationsRequiringEscalation(){let e=Date.now();return Array.from(this.situations.values()).filter(t=>!["resolved","cancelled"].includes(t.status)&&!t.updates.some(e=>"status_change"===e.type&&e.content.includes("acknowledged"))&&e-t.createdAt.getTime()>("urgent"===t.priority?9e5:72e5))}initializeTemplates(){this.templates.set("emergency-pickup",{id:"emergency-pickup",type:"emergency",name:"Emergency School Pickup",description:"Child needs immediate pickup from school",defaultPriority:"urgent",defaultDeadlineHours:1,requiredFields:["location","emergencyType"],metadataSchema:{emergencyType:"pickup",requiresPickup:!0},autoAssignmentRules:[{condition:"emergency",assignTo:"both"}]}),this.templates.set("forgotten-item",{id:"forgotten-item",type:"logistics",name:"Forgotten Item",description:"Child forgot important item at other parent's house",defaultPriority:"medium",defaultDeadlineHours:24,requiredFields:["items"],metadataSchema:{logisticsType:"forgotten_item"},autoAssignmentRules:[{condition:"logistics",assignTo:"other_parent"}]}),this.templates.set("behavioral-incident",{id:"behavioral-incident",type:"behavioral",name:"Behavioral Incident",description:"Child behavioral issue requiring coordination",defaultPriority:"high",defaultDeadlineHours:48,requiredFields:["incident","childId"],metadataSchema:{behaviorType:"disciplinary",privacyLevel:"both_parents"},autoAssignmentRules:[{condition:"behavioral",assignTo:"both"}]})}getTemplate(e){return Array.from(this.templates.values()).find(t=>t.type===e)}determineAssignment(e,t){if(e.assignedTo&&e.assignedTo.length>0)return e.assignedTo;if(null==t?void 0:t.autoAssignmentRules)switch(t.autoAssignmentRules[0].assignTo){case"both":return e.involvedParties;case"other_parent":return e.involvedParties.filter(t=>t!==e.createdBy)}return[e.createdBy]}calculateDeadline(e,t){if(e.deadline)return e.deadline;if(null==t?void 0:t.defaultDeadlineHours){let e=new Date;return e.setHours(e.getHours()+t.defaultDeadlineHours),e}let s={urgent:2,high:24,medium:72,low:168}[e.priority||"medium"],a=new Date;return a.setHours(a.getHours()+s),a}increasePriority(e){let t=["low","medium","high","urgent"],s=Math.min(t.indexOf(e)+1,t.length-1);return t[s]}getEscalationActions(e,t){let s=[];switch(t){case 1:s.push("send_reminder","notify_assigned_parties");break;case 2:s.push("increase_priority","notify_emergency_contacts");break;case 3:s.push("create_follow_up_situation","notify_external_parties");break;default:s.push("manual_intervention_required")}return s}async executeEscalationActions(e){console.log("Executing escalation actions for situation ".concat(e.situationId,":"),e.actions)}async notifyAssignedParties(e){console.log("Notifying assigned parties for situation ".concat(e.id,":"),e.assignedTo)}async applyGamificationImpact(e){e.gamificationImpact&&console.log("Applying gamification impact for situation ".concat(e.id,":"),e.gamificationImpact)}generateId(){return"sit_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){this.situations=new Map,this.templates=new Map,this.initializeTemplates()}}new l;class o extends l{async createEmergency(e){let t={...e,priority:"urgent",status:"created"},s=await this.createSituation(t),a=this.calculateEstimatedResolutionTime(s.metadata.urgencyLevel);return s.metadata={...s.metadata,estimatedResolutionTime:a},await this.sendImmediateNotifications(s),await this.scheduleEmergencyEscalation(s),s}async sendQuickResponse(e,t){let s=this.getSituation(e);if(!s)throw Error("Situation ".concat(e," not found"));let a={id:this.generateId(),timestamp:new Date,...t};this.quickResponses.has(e)||this.quickResponses.set(e,[]),this.quickResponses.get(e).push(a),await this.handleQuickResponseUpdate(s,a),await this.addUpdate(e,{userId:a.userId,type:"comment",content:this.formatQuickResponseMessage(a),metadata:{responseType:a.responseType,estimatedArrival:a.estimatedArrival,location:a.location}}),await this.notifyQuickResponse(s,a)}async trackLocation(e,t,s){this.locationTracking.has(e)||this.locationTracking.set(e,new Map),this.locationTracking.get(e).set(t,s),await this.addUpdate(e,{userId:t,type:"comment",content:"Location updated: ".concat(s[0].toFixed(6),", ").concat(s[1].toFixed(6)),metadata:{location:s,locationType:"gps_update"}})}async escalateToEmergencyContacts(e){let t=this.getSituation(e);if(!t)throw Error("Emergency situation ".concat(e," not found"));let s=t.metadata.emergencyContacts||[];if(0===s.length)return void console.warn("No emergency contacts configured for situation ".concat(e));await this.escalateSituation(e,"No response from assigned parties - escalating to emergency contacts"),await this.notifyEmergencyContacts(t,s),t.metadata.urgencyLevel>=4&&await this.handleHighUrgencyEscalation(t)}async getActiveEmergencies(e){return(await this.getSituations({type:["emergency"],status:["created","acknowledged","in-progress","escalated"]})).filter(t=>t.involvedParties.includes(e)||t.assignedTo.includes(e))}getQuickResponses(e){return this.quickResponses.get(e)||[]}getLocationTracking(e){return this.locationTracking.get(e)||new Map}requiresImmediateEscalation(e){let{urgencyLevel:t,requiresMedicalAttention:s}=e.metadata;return!!(5===t||s&&t>=3||e.deadline&&e.deadline.getTime()-Date.now()<9e5)||!1}calculateEstimatedResolutionTime(e){switch(e){case 5:return 15;case 4:return 30;case 3:default:return 60;case 2:return 120;case 1:return 240}}async sendImmediateNotifications(e){var t;console.log("\uD83D\uDEA8 EMERGENCY NOTIFICATION: ".concat(e.title)),console.log("Assigned to: ".concat(e.assignedTo.join(", "))),console.log("Urgency Level: ".concat(e.metadata.urgencyLevel,"/5")),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.name)||"Not specified"))}async scheduleEmergencyEscalation(e){let t=this.getEscalationDelay(e);console.log("Scheduling emergency escalation for situation ".concat(e.id," in ").concat(t," minutes"))}getEscalationDelay(e){let{urgencyLevel:t}=e.metadata;switch(t){case 5:return 5;case 4:return 10;case 3:default:return 15;case 2:return 30;case 1:return 60}}async handleQuickResponseUpdate(e,t){let s=e.status;switch(t.responseType){case"acknowledged":"created"===e.status&&(s="acknowledged");break;case"on_way":s="in-progress";break;case"handled":s="resolved";break;case"need_help":await this.escalateToEmergencyContacts(e.id);break;case"cant_help":await this.handleCannotHelp(e,t)}s!==e.status&&await this.updateSituation(e.id,{status:s})}formatQuickResponseMessage(e){let t={acknowledged:"Acknowledged the emergency",on_way:"On my way",handled:"Situation handled",need_help:"Need additional help",cant_help:"Cannot help with this emergency"}[e.responseType];return e.estimatedArrival&&(t+=" - ETA: ".concat(e.estimatedArrival.toLocaleTimeString())),e.message&&(t+=" - ".concat(e.message)),t}async notifyQuickResponse(e,t){let s=e.involvedParties.filter(e=>e!==t.userId);console.log("Notifying parties about quick response: ".concat(s.join(", "))),console.log("Response: ".concat(this.formatQuickResponseMessage(t)))}async notifyEmergencyContacts(e,t){console.log("\uD83D\uDEA8 ESCALATING TO EMERGENCY CONTACTS: ".concat(t.join(", "))),console.log("Emergency: ".concat(e.title)),console.log("Urgency: ".concat(e.metadata.urgencyLevel,"/5"))}async handleHighUrgencyEscalation(e){if(5===e.metadata.urgencyLevel){var t;console.log("⚠️  LEVEL 5 EMERGENCY - Consider calling 911"),console.log("Emergency: ".concat(e.title)),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.address)||"Unknown"))}await this.addUpdate(e.id,{userId:"system",type:"escalation",content:"High urgency emergency (Level ".concat(e.metadata.urgencyLevel,") - Additional safety protocols activated"),metadata:{urgencyLevel:e.metadata.urgencyLevel,autoEscalation:!0}})}async handleCannotHelp(e,t){let s=e.involvedParties.filter(s=>s!==t.userId&&!e.assignedTo.includes(s));s.length>0?(await this.updateSituation(e.id,{assignedTo:[...e.assignedTo,...s]}),await this.addUpdate(e.id,{userId:"system",type:"status_change",content:"Reassigned to additional parties: ".concat(s.join(", ")),metadata:{reassignment:!0,originalResponder:t.userId}})):await this.escalateToEmergencyContacts(e.id)}constructor(...e){super(...e),this.quickResponses=new Map,this.locationTracking=new Map}}let c=new o;var d=s(6695),u=s(285),m=s(2523),g=s(8539),h=s(9409),p=s(5057),x=s(4899);let y={logistics:{icon:"\uD83D\uDCE6",label:"Logistics",description:"Coordinate items, schedules, and pickups",color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"},barter:{icon:"\uD83D\uDD04",label:"Barter/Trade",description:"Propose exchanges and swaps",color:"from-green-500 to-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},behavioral:{icon:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66",label:"Behavioral",description:"Coordinate parenting responses",color:"from-purple-500 to-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"},administrative:{icon:"\uD83D\uDCCB",label:"Administrative",description:"Handle paperwork and forms",color:"from-gray-500 to-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200"},meal:{icon:"\uD83C\uDF7D️",label:"Meal Accountability",description:"Address meal responsibility and quality concerns",color:"from-orange-500 to-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200"},emergency:{icon:"⚠️",label:"Emergency",description:"Urgent situations requiring immediate attention",color:"from-red-500 to-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}};function f(e){let{relationshipId:t,currentUserId:s,involvedParties:i,onSituationCreated:n,isGuestMode:l=!1}=e,[o,c]=(0,r.useState)(!1),[f,b]=(0,r.useState)("logistics"),[v,j]=(0,r.useState)({title:"",description:"",priority:"medium",assignedTo:[],deadline:"",metadata:{}}),N=y[f],w=async e=>{if(e.preventDefault(),!o){c(!0);try{let e={id:"situation-".concat(Date.now()),relationshipId:t,type:f,title:v.title,description:v.description,priority:v.priority,status:"created",createdBy:s,assignedTo:v.assignedTo.length>0?v.assignedTo:i.filter(e=>e!==s),involvedParties:i,createdAt:new Date,deadline:v.deadline?new Date(v.deadline):void 0,metadata:D(f,v.metadata),updates:[],escalations:[]};l&&x.B.saveGuestInteraction("demo_action",{type:"situation_created",situationType:f,title:v.title,priority:v.priority,source:"situation_creator"}),n(e),j({title:"",description:"",priority:"medium",assignedTo:[],deadline:"",metadata:{}}),b("logistics")}catch(e){console.error("Error creating situation:",e)}finally{c(!1)}}},D=(e,t)=>{switch(e){case"emergency":return{emergencyType:t.emergencyType||"other",urgencyLevel:t.urgencyLevel||3,location:t.location,requiresPickup:t.requiresPickup||!1,requiresMedicalAttention:t.requiresMedicalAttention||!1,emergencyContacts:t.emergencyContacts||[]};case"logistics":return{logisticsType:t.logisticsType||"other",items:t.items||[],location:t.location,pickupRequired:t.pickupRequired||!1};case"barter":return{offering:t.offering||[],requesting:t.requesting||[],fairnessScore:t.fairnessScore||50,expiresAt:t.expiresAt};case"behavioral":return{behaviorType:t.behaviorType||"other",severity:t.severity||3,childId:t.childId,incident:t.incident,parentalResponse:t.parentalResponse};default:return t}},C=(e,t)=>{j(s=>({...s,metadata:{...s.metadata,[e]:t}}))},k=e=>{switch(e){case"urgent":return"\uD83D\uDEA8";case"high":return"\uD83D\uDD34";case"medium":return"\uD83D\uDFE1";case"low":return"\uD83D\uDFE2";default:return"⚪"}};return(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)(d.Zp,{className:"shadow-lg border-2 ".concat(N.borderColor," ").concat(N.bgColor," transition-all duration-300"),children:[(0,a.jsx)(d.aR,{className:"bg-gradient-to-r ".concat(N.color," text-white rounded-t-lg"),children:(0,a.jsxs)(d.ZB,{className:"text-2xl flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-3xl",children:N.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Create New Situation"}),(0,a.jsx)("div",{className:"text-sm font-normal opacity-90 mt-1",children:N.description})]})]})}),(0,a.jsx)(d.Wu,{className:"p-6",children:(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(p.J,{htmlFor:"situationType",className:"text-lg font-semibold",children:"Choose Situation Type"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(y).map(e=>{let[t,s]=e;return(0,a.jsxs)("button",{type:"button",onClick:()=>b(t),className:"p-4 rounded-lg border-2 transition-all duration-200 hover:scale-105 ".concat(f===t?"".concat(s.borderColor," ").concat(s.bgColor," shadow-md"):"border-gray-200 bg-white hover:border-gray-300"),children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:s.icon}),(0,a.jsx)("div",{className:"text-sm font-medium",children:s.label})]},t)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)(p.J,{htmlFor:"title",className:"text-base font-medium",children:"Situation Title"}),(0,a.jsx)(m.p,{id:"title",required:!0,placeholder:"Brief, clear title for the situation",value:v.title,onChange:e=>j(t=>({...t,title:e.target.value})),className:"mt-1 text-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"priority",className:"text-base font-medium",children:"Priority Level"}),(0,a.jsxs)(h.l6,{value:v.priority,onValueChange:e=>j(t=>({...t,priority:e})),children:[(0,a.jsx)(h.bq,{className:"mt-1",children:(0,a.jsx)(h.yv,{})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsxs)(h.eb,{value:"low",children:[k("low")," Low Priority"]}),(0,a.jsxs)(h.eb,{value:"medium",children:[k("medium")," Medium Priority"]}),(0,a.jsxs)(h.eb,{value:"high",children:[k("high")," High Priority"]}),(0,a.jsxs)(h.eb,{value:"urgent",children:[k("urgent")," Urgent"]})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"description",className:"text-base font-medium",children:"Detailed Description"}),(0,a.jsx)(g.T,{id:"description",required:!0,placeholder:"Provide a clear, detailed description of the situation and what needs to be done",value:v.description,onChange:e=>j(t=>({...t,description:e.target.value})),className:"mt-1 min-h-[100px]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"deadline",className:"text-base font-medium",children:"Deadline (Optional)"}),(0,a.jsx)(m.p,{id:"deadline",type:"datetime-local",value:v.deadline,onChange:e=>j(t=>({...t,deadline:e.target.value})),className:"mt-1"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Set a deadline if this situation is time-sensitive"})]}),(()=>{switch(f){case"emergency":return(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-red-600 text-lg",children:"⚠️"}),(0,a.jsx)("h4",{className:"font-medium text-red-800",children:"Emergency Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"emergencyType",className:"text-red-700",children:"Emergency Type"}),(0,a.jsxs)(h.l6,{onValueChange:e=>C("emergencyType",e),children:[(0,a.jsx)(h.bq,{className:"border-red-300 focus:border-red-500",children:(0,a.jsx)(h.yv,{placeholder:"Select emergency type"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"pickup",children:"\uD83C\uDFEB School/Daycare Pickup"}),(0,a.jsx)(h.eb,{value:"injury",children:"\uD83E\uDE79 Injury/Accident"}),(0,a.jsx)(h.eb,{value:"illness",children:"\uD83E\uDD12 Illness"}),(0,a.jsx)(h.eb,{value:"behavioral",children:"\uD83D\uDE24 Behavioral Emergency"}),(0,a.jsx)(h.eb,{value:"other",children:"❓ Other Emergency"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"urgencyLevel",className:"text-red-700",children:"Urgency Level"}),(0,a.jsxs)(h.l6,{onValueChange:e=>C("urgencyLevel",parseInt(e)),children:[(0,a.jsx)(h.bq,{className:"border-red-300 focus:border-red-500",children:(0,a.jsx)(h.yv,{placeholder:"Select urgency"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"1",children:"\uD83D\uDFE2 1 - Low"}),(0,a.jsx)(h.eb,{value:"2",children:"\uD83D\uDFE1 2 - Moderate"}),(0,a.jsx)(h.eb,{value:"3",children:"\uD83D\uDFE0 3 - High"}),(0,a.jsx)(h.eb,{value:"4",children:"\uD83D\uDD34 4 - Very High"}),(0,a.jsx)(h.eb,{value:"5",children:"\uD83D\uDEA8 5 - Critical"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"location",className:"text-red-700",children:"Location"}),(0,a.jsx)(m.p,{id:"location",placeholder:"Where is the emergency?",value:v.metadata.location||"",onChange:e=>C("location",e.target.value),className:"border-red-300 focus:border-red-500"})]})]});case"logistics":return(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-blue-600 text-lg",children:"\uD83D\uDCE6"}),(0,a.jsx)("h4",{className:"font-medium text-blue-800",children:"Logistics Details"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"logisticsType",className:"text-blue-700",children:"Logistics Type"}),(0,a.jsxs)(h.l6,{onValueChange:e=>C("logisticsType",e),children:[(0,a.jsx)(h.bq,{className:"border-blue-300 focus:border-blue-500",children:(0,a.jsx)(h.yv,{placeholder:"Select logistics type"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"forgotten_item",children:"\uD83C\uDF92 Forgotten Item"}),(0,a.jsx)(h.eb,{value:"schedule_change",children:"\uD83D\uDCC5 Schedule Change"}),(0,a.jsx)(h.eb,{value:"pickup_coordination",children:"\uD83D\uDE97 Pickup Coordination"}),(0,a.jsx)(h.eb,{value:"item_transfer",children:"\uD83D\uDCE6 Item Transfer"}),(0,a.jsx)(h.eb,{value:"other",children:"\uD83D\uDCCB Other"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"items",className:"text-blue-700",children:"Items/Details"}),(0,a.jsx)(g.T,{id:"items",placeholder:"What items or details need coordination?",value:v.metadata.items||"",onChange:e=>C("items",e.target.value),className:"border-blue-300 focus:border-blue-500 min-h-[80px]"})]})]});case"barter":return(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-green-600 text-lg",children:"\uD83D\uDD04"}),(0,a.jsx)("h4",{className:"font-medium text-green-800",children:"Trade Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"offering",className:"text-green-700",children:"What You're Offering"}),(0,a.jsx)(g.T,{id:"offering",placeholder:"What are you willing to give up or trade?",value:v.metadata.offering||"",onChange:e=>C("offering",e.target.value),className:"border-green-300 focus:border-green-500 min-h-[80px]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"requesting",className:"text-green-700",children:"What You're Requesting"}),(0,a.jsx)(g.T,{id:"requesting",placeholder:"What do you want in return?",value:v.metadata.requesting||"",onChange:e=>C("requesting",e.target.value),className:"border-green-300 focus:border-green-500 min-h-[80px]"})]})]})]});case"behavioral":return(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-purple-600 text-lg",children:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66"}),(0,a.jsx)("h4",{className:"font-medium text-purple-800",children:"Behavioral Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"behaviorType",className:"text-purple-700",children:"Behavior Type"}),(0,a.jsxs)(h.l6,{onValueChange:e=>C("behaviorType",e),children:[(0,a.jsx)(h.bq,{className:"border-purple-300 focus:border-purple-500",children:(0,a.jsx)(h.yv,{placeholder:"Select behavior type"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"academic",children:"\uD83D\uDCDA Academic Issues"}),(0,a.jsx)(h.eb,{value:"social",children:"\uD83D\uDC6B Social Issues"}),(0,a.jsx)(h.eb,{value:"emotional",children:"\uD83D\uDCAD Emotional Issues"}),(0,a.jsx)(h.eb,{value:"disciplinary",children:"⚖️ Disciplinary Issues"}),(0,a.jsx)(h.eb,{value:"developmental",children:"\uD83C\uDF31 Developmental Concerns"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"severity",className:"text-purple-700",children:"Severity Level"}),(0,a.jsxs)(h.l6,{onValueChange:e=>C("severity",parseInt(e)),children:[(0,a.jsx)(h.bq,{className:"border-purple-300 focus:border-purple-500",children:(0,a.jsx)(h.yv,{placeholder:"Select severity"})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"1",children:"\uD83D\uDFE2 1 - Minor"}),(0,a.jsx)(h.eb,{value:"2",children:"\uD83D\uDFE1 2 - Moderate"}),(0,a.jsx)(h.eb,{value:"3",children:"\uD83D\uDFE0 3 - Significant"}),(0,a.jsx)(h.eb,{value:"4",children:"\uD83D\uDD34 4 - Major"}),(0,a.jsx)(h.eb,{value:"5",children:"\uD83D\uDEA8 5 - Severe"})]})]})]})]})]});default:return null}})(),(0,a.jsx)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:(0,a.jsx)(u.$,{type:"submit",disabled:o||!v.title||!v.description,className:"px-8 py-3 text-lg font-medium transition-all duration-200 ".concat("emergency"===f?"bg-red-600 hover:bg-red-700 text-white shadow-lg hover:shadow-xl":"bg-gradient-to-r ".concat(N.color," text-white shadow-lg hover:shadow-xl hover:scale-105")),children:o?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Creating..."})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:N.icon}),(0,a.jsxs)("span",{children:["Create ",N.label]})]})})}),l&&(0,a.jsx)("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("span",{className:"text-blue-600 text-xl",children:"\uD83C\uDFAD"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-blue-800",children:"Demo Mode Active"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"This situation will be created for demonstration purposes. In a real implementation, it would be saved to the database and notifications sent to your co-parent."})]})]})})]})})]})})}function b(e){var t;let{situation:s,currentUserId:i,onResponseSent:n,isGuestMode:l=!1}=e,[o,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(null),[p,y]=(0,r.useState)(""),[f,b]=(0,r.useState)(""),v=async e=>{if(!o){m(!0),h(e);try{let t={situationId:s.id,userId:i,responseType:e,message:p||void 0,estimatedArrival:f?new Date(f):void 0};if(l){x.B.saveGuestInteraction("demo_action",{type:"emergency_quick_response",situationId:s.id,responseType:e,message:p,source:"quick_response"});let a={id:"qr_".concat(Date.now()),timestamp:new Date,...t};n&&n(a)}else await c.sendQuickResponse(s.id,t);y(""),b(""),h(null)}catch(e){console.error("Error sending quick response:",e)}finally{m(!1)}}};return(0,a.jsx)(d.Zp,{className:"border-l-4 border-l-red-500",children:(0,a.jsxs)(d.Wu,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["\uD83D\uDEA8 ",s.title]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(e=>{let t=Math.floor((new Date().getTime()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let s=Math.floor(t/60);if(s<24)return"".concat(s,"h ago");let a=Math.floor(s/24);return"".concat(a,"d ago")})(s.createdAt)," • ",(null==(t=s.metadata.location)?void 0:t.name)||"Location not specified"]})]})]}),(0,a.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case 5:return"bg-red-600 text-white";case 4:return"bg-red-500 text-white";case 3:return"bg-orange-500 text-white";case 2:return"bg-yellow-500 text-white";case 1:return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}})(s.metadata.urgencyLevel)),children:["Level ",s.metadata.urgencyLevel]})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-gray-800 mb-2",children:s.description}),s.metadata.location&&(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",s.metadata.location.address]}),s.metadata.requiresPickup&&(0,a.jsx)("div",{className:"text-sm text-orange-600 font-medium mt-1",children:"⚠️ Pickup required"}),s.metadata.requiresMedicalAttention&&(0,a.jsx)("div",{className:"text-sm text-red-600 font-medium mt-1",children:"\uD83C\uDFE5 Medical attention needed"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Quick Response:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{type:"acknowledged",label:"Acknowledged",icon:"✓",description:"I see this emergency",color:"bg-blue-100 text-blue-800 hover:bg-blue-200"},{type:"on_way",label:"On My Way",icon:"\uD83D\uDE97",description:"I'm heading there now",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"handled",label:"Handled",icon:"✅",description:"Situation is resolved",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"need_help",label:"Need Help",icon:"\uD83C\uDD98",description:"I need additional assistance",color:"bg-orange-100 text-orange-800 hover:bg-orange-200"},{type:"cant_help",label:"Can't Help",icon:"❌",description:"I'm unable to assist",color:"bg-red-100 text-red-800 hover:bg-red-200"}].map(e=>(0,a.jsxs)(u.$,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2 ".concat(e.color," ").concat(g===e.type?"ring-2 ring-blue-500":""),onClick:()=>v(e.type),disabled:o,children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-medium",children:e.label}),(0,a.jsx)("div",{className:"text-xs opacity-75",children:e.description})]})]},e.type))}),("on_way"===g||"need_help"===g||"cant_help"===g)&&(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg",children:["on_way"===g&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Arrival Time"}),(0,a.jsx)("input",{type:"datetime-local",value:f,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().slice(0,16)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Message (Optional)"}),(0,a.jsx)("textarea",{value:p,onChange:e=>y(e.target.value),placeholder:"Add any additional details...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]})]}),o&&(0,a.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Sending response..."})]})]}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(u.$,{variant:"outline",size:"sm",children:["\uD83D\uDCDE Call ",s.assignedTo[0]||"Parent"]}),(0,a.jsx)(u.$,{variant:"outline",size:"sm",children:"\uD83D\uDCCD Get Directions"}),s.metadata.urgencyLevel>=4&&(0,a.jsx)(u.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:"\uD83D\uDEA8 Call 911"})]})}),l&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,a.jsx)("span",{className:"font-medium",children:"Demo Mode:"})," In a real emergency, your response would immediately notify all involved parties and update the situation status."]})})]})})}function v(e){var t,s;let{situation:i,onUpdate:n,isGuestMode:l=!1,isResolved:o=!1}=e,[c,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),p=async e=>{if(!c){m(!0);try{l&&x.B.saveGuestInteraction("demo_action",{type:"situation_status_update",situationId:i.id,oldStatus:i.status,newStatus:e,source:"situation_card"}),n&&n({status:e})}catch(e){console.error("Error updating situation:",e)}finally{m(!1)}}},y=e=>{let t=Math.floor((new Date().getTime()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let s=Math.floor(t/60);if(s<24)return"".concat(s,"h ago");let a=Math.floor(s/24);return"".concat(a,"d ago")};return(0,a.jsxs)(d.Zp,{className:"hover:shadow-lg transition-shadow ".concat(o?"opacity-75":""),children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:(e=>{switch(e){case"emergency":return"\uD83D\uDEA8";case"logistics":return"\uD83D\uDCE6";case"barter":return"\uD83D\uDD04";case"behavioral":return"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66";case"administrative":return"\uD83D\uDCCB";default:return"\uD83D\uDCDD"}})(i.type)}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ZB,{className:"text-lg",children:i.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:i.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["Created ",y(i.createdAt)]}),i.deadline&&(0,a.jsxs)("span",{children:["Deadline: ",new Date(i.deadline).toLocaleDateString()]})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(i.priority)),children:i.priority}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"in-progress":case"acknowledged":return"bg-blue-100 text-blue-800 border-blue-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";case"created":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"escalated":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(i.status)),children:i.status})]})]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Type:"}),(0,a.jsx)("p",{className:"text-gray-600 capitalize",children:i.type})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Created by:"}),(0,a.jsx)("p",{className:"text-gray-600",children:i.createdBy})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Assigned to:"}),(0,a.jsx)("p",{className:"text-gray-600",children:(null==(t=i.assignedTo)?void 0:t.join(", "))||"Unassigned"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Involved:"}),(0,a.jsx)("p",{className:"text-gray-600",children:(null==(s=i.involvedParties)?void 0:s.join(", "))||"None"})]})]}),i.metadata&&Object.keys(i.metadata).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(u.$,{variant:"ghost",size:"sm",onClick:()=>h(!g),className:"text-blue-600 hover:text-blue-800",children:g?"Hide Details":"Show Details"}),g&&(0,a.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Additional Details:"}),(0,a.jsx)("div",{className:"space-y-1 text-sm",children:Object.entries(i.metadata).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-600 capitalize w-24",children:[t.replace(/([A-Z])/g," $1").toLowerCase(),":"]}),(0,a.jsx)("span",{className:"text-gray-700",children:"object"==typeof s?JSON.stringify(s):String(s)})]},t)})})]})]}),i.updates&&i.updates.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Recent Updates:"}),(0,a.jsxs)("div",{className:"space-y-2",children:[i.updates.slice(-3).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start space-x-2 p-2 bg-gray-50 rounded",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700",children:e.content}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[y(e.timestamp)," • ",e.type]})]})]},t)),i.updates.length>3&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["... and ",i.updates.length-3," more updates"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>{l&&x.B.saveGuestInteraction("demo_action",{type:"situation_update_added",situationId:i.id,source:"situation_card"}),alert("Update functionality would open a form to add notes, photos, or status changes.")},disabled:c,children:"Add Update"}),!o&&(0,a.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>h(!g),children:"View Details"})]}),!o&&(0,a.jsxs)("div",{className:"flex space-x-2",children:["created"===i.status&&(0,a.jsx)(u.$,{size:"sm",onClick:()=>p("acknowledged"),disabled:c,children:"Acknowledge"}),("acknowledged"===i.status||"created"===i.status)&&(0,a.jsx)(u.$,{size:"sm",onClick:()=>p("in-progress"),disabled:c,children:"Start Progress"}),("in-progress"===i.status||"acknowledged"===i.status)&&(0,a.jsx)(u.$,{size:"sm",onClick:()=>p("resolved"),disabled:c,className:"bg-green-600 hover:bg-green-700 text-white",children:c?"Resolving...":"Resolve"})]})]}),l&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,a.jsx)("span",{className:"font-medium",children:"Demo Mode:"})," Status updates and interactions are simulated. In a real implementation, these would sync with your co-parent and send notifications."]})})]})})]})}var j=s(6874),N=s.n(j);function w(){let{user:e,isLoading:t,isAuthenticated:c}=(0,i.As)(),m=(0,n.useRouter)(),[g,h]=(0,r.useState)([]),[p,x]=(0,r.useState)(new Map),[y,j]=(0,r.useState)(!0),[w,D]=(0,r.useState)(!1),[C,k]=(0,r.useState)(!1),[T,S]=(0,r.useState)("all");new l,new o,(0,r.useEffect)(()=>{t||c||m.push("/login")},[t,c,m]),(0,r.useEffect)(()=>{if(t)return;let e=async()=>{try{let e=!c;if(D(e),e){let{generateDemoSituations:e}=await s.e(343).then(s.bind(s,7343)),t=e();h(t)}else h([])}catch(e){console.error("Error loading situations:",e)}finally{j(!1)}};if(!c)return void j(!1);e()},[t,c,e]);let E=(e,t)=>{x(s=>{let a=new Map(s),r=a.get(e)||[];return a.set(e,[...r,t]),a}),"handled"===t.responseType?h(t=>t.map(t=>t.id===e?{...t,status:"resolved"}:t)):"on_way"===t.responseType&&h(t=>t.map(t=>t.id===e?{...t,status:"in-progress"}:t))},A=(e,t)=>{h(s=>s.map(s=>s.id===e?{...s,...t}:s))},I=g.filter(e=>"all"===T||e.type===T),R=I.filter(e=>"resolved"!==e.status&&"cancelled"!==e.status),_=I.filter(e=>"resolved"===e.status||"cancelled"===e.status);return t||y?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading situations..."})]})}):e?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Situation Management"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Manage co-parenting coordination, logistics, and situations"}),w&&(0,a.jsxs)("div",{className:"mt-3 inline-flex items-center bg-blue-50 border border-blue-200 rounded-lg px-4 py-2",children:[(0,a.jsx)("div",{className:"text-blue-600 mr-2",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,a.jsx)("span",{className:"text-sm text-blue-800",children:"Demo Mode: Try creating emergency situations and coordinating responses with your co-parent!"})]})]}),(0,a.jsx)("div",{className:"flex space-x-3",children:(0,a.jsx)(u.$,{onClick:()=>k(!C),children:C?"Cancel":"+ Create Situation"})})]}),C&&(0,a.jsx)(f,{relationshipId:w?"demo-relationship":"user-relationship",currentUserId:w?"parent-1":"current-user",involvedParties:w?["parent-1","parent-2"]:["current-user","co-parent"],onSituationCreated:e=>{h(t=>[e,...t]),k(!1)},isGuestMode:w}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"all",label:"All Situations",count:g.length},{key:"logistics",label:"Logistics",count:g.filter(e=>"logistics"===e.type).length},{key:"barter",label:"Barter/Trade",count:g.filter(e=>"barter"===e.type).length},{key:"behavioral",label:"Behavioral",count:g.filter(e=>"behavioral"===e.type).length},{key:"emergency",label:"Emergencies",count:g.filter(e=>"emergency"===e.type).length}].map(e=>(0,a.jsxs)("button",{onClick:()=>S(e.key),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat(T===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.label,e.count>0&&(0,a.jsx)("span",{className:"ml-2 py-0.5 px-2 rounded-full text-xs ".concat(T===e.key?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.count})]},e.key))})}),R.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Active Situations (",R.length,")"]}),(0,a.jsx)("div",{className:"space-y-4",children:R.map(e=>(0,a.jsxs)("div",{children:["emergency"===e.type?(0,a.jsx)(b,{situation:e,currentUserId:w?"parent-2":"current-user",onResponseSent:t=>E(e.id,t),isGuestMode:w}):(0,a.jsx)(v,{situation:e,onUpdate:t=>A(e.id,t),isGuestMode:w}),p.get(e.id)&&p.get(e.id).length>0&&(0,a.jsxs)(d.Zp,{className:"mt-4 border-l-4 border-l-green-500",children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-lg",children:"Recent Responses"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:p.get(e.id).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-green-50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-green-600 text-sm",children:"✓"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"font-medium text-green-800",children:["acknowledged"===e.responseType&&"✓ Acknowledged","on_way"===e.responseType&&"\uD83D\uDE97 On My Way","handled"===e.responseType&&"✅ Handled","need_help"===e.responseType&&"\uD83C\uDD98 Need Help","cant_help"===e.responseType&&"❌ Can't Help"]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.timestamp.toLocaleTimeString()})]}),e.message&&(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:e.message}),e.estimatedArrival&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["ETA: ",e.estimatedArrival.toLocaleTimeString()]})]})]},t))})})]})]},e.id))})]}),_.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Resolved Situations (",_.length,")"]}),(0,a.jsx)("div",{className:"space-y-4",children:_.map(e=>(0,a.jsx)(v,{situation:e,onUpdate:t=>A(e.id,t),isGuestMode:w,isResolved:!0},e.id))})]}),0===I.length&&(0,a.jsx)(d.Zp,{children:(0,a.jsxs)(d.Wu,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:"emergency"===T?(0,a.jsx)("span",{className:"text-4xl",children:"\uD83D\uDEA8"}):"logistics"===T?(0,a.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCE6"}):"barter"===T?(0,a.jsx)("span",{className:"text-4xl",children:"\uD83D\uDD04"}):"behavioral"===T?(0,a.jsx)("span",{className:"text-4xl",children:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66"}):(0,a.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"all"===T?w?"No Demo Situations Available":"No Situations Yet":"No ".concat(T," situations")}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"emergency"===T?"Create an emergency situation when urgent coordination is needed.":"logistics"===T?"Track forgotten items, schedule changes, and coordination needs.":"barter"===T?"Propose trades and exchanges with your co-parent.":"behavioral"===T?"Coordinate responses to behavioral situations and maintain consistency.":w?"Try creating different types of situations to see how they work.":"Create your first situation to start managing co-parenting coordination."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,a.jsx)(u.$,{onClick:()=>k(!0),children:"+ Create Situation"}),w&&(0,a.jsx)(N(),{href:"/situations-demo",children:(0,a.jsx)(u.$,{variant:"outline",children:"Try Interactive Demo"})})]})]})}),w&&g.length>0&&(0,a.jsx)(d.Zp,{className:"bg-blue-50 border-blue-200",children:(0,a.jsxs)(d.Wu,{className:"text-center py-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Ready to manage real situations?"}),(0,a.jsx)("p",{className:"text-blue-700 mb-4",children:"Sign up to create actual situations and coordinate with your co-parent."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,a.jsx)(N(),{href:"/onboarding",children:(0,a.jsx)(u.$,{children:"Complete Onboarding"})}),(0,a.jsx)(N(),{href:"/situations-demo",children:(0,a.jsx)(u.$,{variant:"outline",children:"Try More Demos"})})]})]})})]})})}):null}},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},6695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>n,aR:()=>l});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},8539:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",s),ref:t,...r})});n.displayName="Textarea"},9409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>l,eb:()=>d,gC:()=>c,l6:()=>n,yv:()=>o});var a=s(5155),r=s(2115),i=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("select",{className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",s),ref:t,...n,children:r})});n.displayName="Select";let l=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",s),...n,children:r})});l.displayName="SelectTrigger";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("span",{ref:t,className:(0,i.cn)("block truncate",s),...r})});o.displayName="SelectValue";let c=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md","border-gray-200 bg-white shadow-lg",s),...n,children:r})});c.displayName="SelectContent";let d=r.forwardRef((e,t)=>{let{className:s,children:r,value:n,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50","hover:bg-gray-100 focus:bg-gray-100",s),"data-value":n,...l,children:r})});d.displayName="SelectItem"},9434:(e,t,s)=>{"use strict";s.d(t,{Fd:()=>o,Uj:()=>n,cn:()=>i,wz:()=>l});var a=s(2596),r=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}function n(e){let t=e.startsWith("/")?"".concat("/pr-69").concat(e):e;window.location.href=t}function l(e,t){return e===t||("/"===t?"/"===e:e.startsWith(t+"/")||e===t)}function o(e){return e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?e:"/".concat(e):"/"}}},e=>{var t=t=>e(e.s=t);e.O(0,[982,277,874,715,899,441,684,358],()=>t(1851)),_N_E=e.O()}]);