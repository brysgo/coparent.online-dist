"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{3030:(e,t,a)=>{a.r(t),a.d(t,{ExpenseBalance:()=>l});var i=a(5155),s=a(2115),r=a(3715),n=a(3579),o=a(3793);function l(){let{user:e}=(0,r.As)(),[t,a]=(0,s.useState)(null),[l,d]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[m,_]=(0,s.useState)(!1),x=(0,s.useMemo)(()=>(0,o.HP)()?null:(0,n.createClientComponentClient)(),[]);if((0,s.useEffect)(()=>{async function t(){if((0,o.HP)()){_(!0),a((0,o._g)()),d(!1);return}if(!e)return void d(!1);try{let{data:t,error:i}=await x.from("co_parent_relationships").select("id").or("parent_a_id.eq.".concat(e.id,",parent_b_id.eq.").concat(e.id)).limit(1);if(i)throw i;if(!t||0===t.length){a({who_owes:null,who_owes_id:null,owes_to:null,owes_to_id:null,amount:0}),d(!1);return}let s=t[0].id,{data:r,error:n}=await x.rpc("get_balance",{family_id:s});if(n)throw n;a(r)}catch(e){console.error("Error fetching balance:",e),u(e instanceof Error?e.message:"Failed to load balance")}finally{d(!1)}}if(t(),!(0,o.HP)()&&x){let e=x.channel("expense_changes").on("postgres_changes",{event:"*",schema:"public",table:"shared_expenses"},()=>{t()}).subscribe();return()=>{e.unsubscribe()}}},[e,x]),l)return(0,i.jsxs)("div",{className:"animate-pulse",children:[(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,i.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(c)return(0,i.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Error loading balance: ",c]});if(!t)return(0,i.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"No expense data available"});if(0===t.amount)return(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:"$0.00"}),(0,i.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"All expenses are settled up! \uD83C\uDF89"}),m&&(0,i.jsx)("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:"\uD83D\uDCCA Demo Mode - Sample data"})]});let h=m?(0,o.iQ)():e,f=t.who_owes_id===(null==h?void 0:h.id);return(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("div",{className:"text-2xl font-bold ".concat(f?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:["$",t.amount.toFixed(2)]}),(0,i.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:f?(0,i.jsxs)(i.Fragment,{children:["You owe ",(0,i.jsx)("span",{className:"font-medium",children:t.owes_to})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"font-medium",children:t.who_owes})," owes you"]})}),m&&(0,i.jsx)("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:"\uD83D\uDCCA Demo Mode - Sample data"})]})}},3793:(e,t,a)=>{a.d(t,{HP:()=>n,Ti:()=>s,_5:()=>i,_g:()=>r,iQ:()=>o});let i=[{id:"user-1",full_name:"Alex Johnson",email:"alex@example.com"},{id:"user-2",full_name:"Jordan Smith",email:"jordan@example.com"}],s=[{id:"1",amount:75,description:"Soccer cleats for Emma",category:"Sports & Activities",expense_date:"2024-01-15",paid_by:"user-1",split_method:"fifty_fifty",reimbursed:!1,family_id:"family-1",created_at:"2024-01-15T10:30:00Z"},{id:"2",amount:120,description:"Pediatric dentist appointment",category:"Healthcare",expense_date:"2024-01-12",paid_by:"user-2",split_method:"fifty_fifty",reimbursed:!0,family_id:"family-1",created_at:"2024-01-12T14:15:00Z"},{id:"3",amount:89.99,description:"Winter jacket",category:"Clothing",expense_date:"2024-01-10",paid_by:"user-1",split_method:"fifty_fifty",reimbursed:!0,family_id:"family-1",created_at:"2024-01-10T16:45:00Z"},{id:"4",amount:45.5,description:"School lunch program",category:"Education",expense_date:"2024-01-08",paid_by:"user-2",split_method:"fifty_fifty",reimbursed:!1,family_id:"family-1",created_at:"2024-01-08T09:20:00Z"}];function r(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=0,t=0;s.forEach(a=>{if(!a.reimbursed){let i=a.amount/2;"user-1"===a.paid_by?e+=i:t+=i}});let a=Math.abs(e-t);return e>t?{who_owes:"Jordan Smith",who_owes_id:"user-2",owes_to:"Alex Johnson",owes_to_id:"user-1",amount:a}:t>e?{who_owes:"Alex Johnson",who_owes_id:"user-1",owes_to:"Jordan Smith",owes_to_id:"user-2",amount:a}:{who_owes:null,who_owes_id:null,owes_to:null,owes_to_id:null,amount:0}}function n(){return!1}function o(){return i[0]}}}]);