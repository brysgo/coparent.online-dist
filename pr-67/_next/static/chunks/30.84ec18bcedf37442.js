"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{3030:(e,t,a)=>{a.r(t),a.d(t,{ExpenseBalance:()=>i});var s=a(5155),r=a(2115),n=a(3715),l=a(3579);function i(){let{user:e}=(0,n.As)(),[t,a]=(0,r.useState)(null),[i,d]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null),u=(0,l.createClientComponentClient)();if((0,r.useEffect)(()=>{async function t(){if(!e)return void d(!1);try{let{data:t,error:s}=await u.from("co_parent_relationships").select("id").or("parent_a_id.eq.".concat(e.id,",parent_b_id.eq.").concat(e.id)).limit(1);if(s)throw s;if(!t||0===t.length){a({who_owes:null,who_owes_id:null,owes_to:null,owes_to_id:null,amount:0}),d(!1);return}let r=t[0].id,{data:n,error:l}=await u.rpc("get_balance",{family_id:r});if(l)throw l;a(n)}catch(e){console.error("Error fetching balance:",e),o(e instanceof Error?e.message:"Failed to load balance")}finally{d(!1)}}t();let s=u.channel("expense_changes").on("postgres_changes",{event:"*",schema:"public",table:"shared_expenses"},()=>{t()}).subscribe();return()=>{s.unsubscribe()}},[e,u]),i)return(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(c)return(0,s.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Error loading balance: ",c]});if(!t)return(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"No expense data available"});if(0===t.amount)return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:"$0.00"}),(0,s.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"All expenses are settled up! \uD83C\uDF89"})]});let x=t.who_owes_id===(null==e?void 0:e.id);return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold ".concat(x?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:["$",t.amount.toFixed(2)]}),(0,s.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:x?(0,s.jsxs)(s.Fragment,{children:["You owe ",(0,s.jsx)("span",{className:"font-medium",children:t.owes_to})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"font-medium",children:t.who_owes})," owes you"]})})]})}}}]);