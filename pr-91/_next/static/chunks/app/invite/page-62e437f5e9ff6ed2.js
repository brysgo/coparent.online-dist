(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{396:(e,n,s)=>{Promise.resolve().then(s.bind(s,9331))},844:(e,n,s)=>{"use strict";s.d(n,{GY:()=>r,h9:()=>c,hV:()=>l});var i=s(9509);function t(){let e=a();return"main"===e||"master"===e||"production"===e?"production":"development"}function a(){return"copilot/fix-82"}function c(){if("production"===t())return{url:i.env.NEXT_PUBLIC_SUPABASE_URL||"https://placeholder.supabase.co",anonKey:i.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"placeholder-anon-key",serviceRoleKey:i.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"};{let e=i.env.SUPABASE_DEV_URL||"https://bqiapoplmkkrtnsmmxhs.supabase.co";return{url:e,anonKey:i.env.SUPABASE_DEV_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NDA3OTMsImV4cCI6MjA2ODAxNjc5M30.bZGNGvb8XYZSWkbfMYMNBAzoedp4SGOIerHmNcRqUsk",serviceRoleKey:i.env.SUPABASE_DEV_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ0MDc5MywiZXhwIjoyMDY4MDE2NzkzfQ.7m9y2vqrq1Sd8bX6dl6A47WQbZoQHGKc7o2rzrcTjKI"}}}function l(e){return"https://placeholder.supabase.co"!==e.url&&"placeholder-anon-key"!==e.anonKey&&(e.url.includes("supabase.co")||e.url.includes("127.0.0.1"))}function r(){let e=a(),n=t(),s=c(),i=l(s);return{currentBranch:e,environment:n,supabaseUrl:s.url,hasValidConfig:i,configSource:"production"===n?"production":"development-default"}}},2099:(e,n,s)=>{"use strict";s.d(n,{k:()=>c});var i=s(4982),t=s(844);let a=null,c=()=>{if(a)return a;let e=(0,t.h9)();return a=(0,t.hV)(e)?(0,i.UU)(e.url,e.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}}):(0,i.UU)("https://placeholder.supabase.co","placeholder-anon-key",{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}})}},9331:(e,n,s)=>{"use strict";s.d(n,{InvitationAcceptance:()=>d});var i=s(5155),t=s(2115),a=s(5695),c=s(285),l=s(6695),r=s(9657),o=s(2099);function d(){let[e,n]=(0,t.useState)(null),[s,d]=(0,t.useState)(!0),[u,h]=(0,t.useState)(!1),[m,x]=(0,t.useState)(null),{acceptInvitation:p,rejectInvitation:v,loading:f,error:j}=(0,r._)(),N=(0,o.k)(),I=(0,a.useRouter)(),y=(0,a.useSearchParams)().get("code");(0,t.useEffect)(()=>{b(),y&&_()},[y]);let b=async()=>{let{data:{user:e}}=await N.auth.getUser();h(!!e)},_=async()=>{if(!y){x("No invitation code provided"),d(!1);return}try{let{data:e,error:s}=await N.from("co_parent_invitations").select("\n          *,\n          children(name),\n          users!inviter_id(full_name, email)\n        ").eq("invitation_code",y).eq("status","pending").single();if(s||!e)return void x("Invitation not found or has already been processed");if(new Date(e.expires_at)<new Date)return void x("This invitation has expired");n(e)}catch(e){x("Failed to load invitation details")}finally{d(!1)}},g=async()=>{y&&await p(y)&&I.push("/dashboard?invitation_accepted=true")},S=async()=>{y&&await v(y)&&I.push("/")};return s?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(l.Zp,{className:"w-full max-w-md",children:(0,i.jsx)(l.Wu,{className:"p-6",children:(0,i.jsx)("div",{className:"text-center",children:"Loading invitation..."})})})}):m||!e?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{className:"text-red-600",children:"Invitation Error"})}),(0,i.jsxs)(l.Wu,{children:[(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:m||"Invalid invitation"}),(0,i.jsx)(c.$,{onClick:()=>I.push("/"),className:"w-full",children:"Go to Homepage"})]})]})}):u?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{children:"Accept Co-Parent Invitation"})}),(0,i.jsx)(l.Wu,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("p",{className:"text-lg font-medium mb-2",children:[e.users.full_name," has invited you"]}),(0,i.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,i.jsx)("strong",{children:e.children.name})]})]}),j&&(0,i.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,i.jsx)("p",{className:"text-sm text-red-600",children:j})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.$,{onClick:g,disabled:f,className:"w-full",children:f?"Processing...":"Accept Invitation"}),(0,i.jsx)(c.$,{onClick:S,variant:"outline",disabled:f,className:"w-full",children:"Decline Invitation"})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["By accepting, you agree to share custody information for"," ",e.children.name," with ",e.users.full_name,"."]})]})})]})}):(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{children:"Co-Parent Invitation"})}),(0,i.jsx)(l.Wu,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("p",{className:"text-lg font-medium mb-2",children:["You've been invited by ",e.users.full_name]}),(0,i.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,i.jsx)("strong",{children:e.children.name})]})]}),(0,i.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,i.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Benefits of joining:"}),(0,i.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,i.jsx)("li",{children:"• Share schedules and coordinate custody"}),(0,i.jsx)("li",{children:"• Track shared expenses and manage finances"}),(0,i.jsx)("li",{children:"• Manage children's inventory and belongings"}),(0,i.jsx)("li",{children:"• Communicate effectively through the platform"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.$,{onClick:()=>{I.push("/signup?invitation_code=".concat(y))},className:"w-full",children:"Create Account & Accept"}),(0,i.jsx)(c.$,{onClick:()=>{I.push("/login?invitation_code=".concat(y))},variant:"outline",className:"w-full",children:"I already have an account"})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["This invitation expires on"," ",new Date(e.expires_at).toLocaleDateString()]})]})})]})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[277,982,877,441,684,358],()=>n(396)),_N_E=e.O()}]);