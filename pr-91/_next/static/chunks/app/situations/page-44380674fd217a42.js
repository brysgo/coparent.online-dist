(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[850],{1851:(e,s,r)=>{Promise.resolve().then(r.bind(r,9727))},2523:(e,s,r)=>{"use strict";r.d(s,{p:()=>i});var t=r(5155),a=r(2115),l=r(9434);let i=a.forwardRef((e,s)=>{let{className:r,type:a,...i}=e;return(0,t.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",r),ref:s,...i})});i.displayName="Input"},5057:(e,s,r)=>{"use strict";r.d(s,{J:()=>i});var t=r(5155),a=r(2115),l=r(9434);let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("label",{ref:s,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70","text-gray-700",r),...a})});i.displayName="Label"},5695:(e,s,r)=>{"use strict";var t=r(8999);r.o(t,"usePathname")&&r.d(s,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(s,{useSearchParams:function(){return t.useSearchParams}})},8539:(e,s,r)=>{"use strict";r.d(s,{T:()=>i});var t=r(5155),a=r(2115),l=r(9434);let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",r),ref:s,...a})});i.displayName="Textarea"},9409:(e,s,r)=>{"use strict";r.d(s,{bq:()=>n,eb:()=>o,gC:()=>c,l6:()=>i,yv:()=>d});var t=r(5155),a=r(2115),l=r(9434);let i=a.forwardRef((e,s)=>{let{className:r,children:a,...i}=e;return(0,t.jsx)("select",{className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",r),ref:s,...i,children:a})});i.displayName="Select";let n=a.forwardRef((e,s)=>{let{className:r,children:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",r),...i,children:a})});n.displayName="SelectTrigger";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("span",{ref:s,className:(0,l.cn)("block truncate",r),...a})});d.displayName="SelectValue";let c=a.forwardRef((e,s)=>{let{className:r,children:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md","border-gray-200 bg-white shadow-lg",r),...i,children:a})});c.displayName="SelectContent";let o=a.forwardRef((e,s)=>{let{className:r,children:a,value:i,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50","hover:bg-gray-100 focus:bg-gray-100",r),"data-value":i,...n,children:a})});o.displayName="SelectItem"},9727:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>y});var t=r(5155),a=r(2115),l=r(6083),i=r(5695),n=r(3382),d=r(8417),c=r(6695),o=r(285),u=r(2523),x=r(8539),m=r(9409),h=r(5057);let g={logistics:{icon:"\uD83D\uDCE6",label:"Logistics",description:"Coordinate items, schedules, and pickups",color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"},barter:{icon:"\uD83D\uDD04",label:"Barter/Trade",description:"Propose exchanges and swaps",color:"from-green-500 to-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},behavioral:{icon:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66",label:"Behavioral",description:"Coordinate parenting responses",color:"from-purple-500 to-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"},administrative:{icon:"\uD83D\uDCCB",label:"Administrative",description:"Handle paperwork and forms",color:"from-gray-500 to-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200"},meal:{icon:"\uD83C\uDF7D️",label:"Meal Accountability",description:"Address meal responsibility and quality concerns",color:"from-orange-500 to-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200"},emergency:{icon:"⚠️",label:"Emergency",description:"Urgent situations requiring immediate attention",color:"from-red-500 to-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}};function p(e){let{relationshipId:s,currentUserId:r,involvedParties:l,onSituationCreated:i}=e,[n,d]=(0,a.useState)(!1),[p,b]=(0,a.useState)("logistics"),[j,y]=(0,a.useState)({title:"",description:"",priority:"medium",assignedTo:[],deadline:"",metadata:{}}),f=g[p],v=async e=>{if(e.preventDefault(),!n){d(!0);try{let e={id:"situation-".concat(Date.now()),relationshipId:s,type:p,title:j.title,description:j.description,priority:j.priority,status:"created",createdBy:r,assignedTo:j.assignedTo.length>0?j.assignedTo:l.filter(e=>e!==r),involvedParties:l,createdAt:new Date,deadline:j.deadline?new Date(j.deadline):void 0,metadata:N(p,j.metadata),updates:[],escalations:[]};i(e),y({title:"",description:"",priority:"medium",assignedTo:[],deadline:"",metadata:{}}),b("logistics")}catch(e){console.error("Error creating situation:",e)}finally{d(!1)}}},N=(e,s)=>{switch(e){case"emergency":return{emergencyType:s.emergencyType||"other",urgencyLevel:s.urgencyLevel||3,location:s.location,requiresPickup:s.requiresPickup||!1,requiresMedicalAttention:s.requiresMedicalAttention||!1,emergencyContacts:s.emergencyContacts||[]};case"logistics":return{logisticsType:s.logisticsType||"other",items:s.items||[],location:s.location,pickupRequired:s.pickupRequired||!1};case"barter":return{offering:s.offering||[],requesting:s.requesting||[],fairnessScore:s.fairnessScore||50,expiresAt:s.expiresAt};case"behavioral":return{behaviorType:s.behaviorType||"other",severity:s.severity||3,childId:s.childId,incident:s.incident,parentalResponse:s.parentalResponse};default:return s}},D=(e,s)=>{y(r=>({...r,metadata:{...r.metadata,[e]:s}}))},w=e=>{switch(e){case"urgent":return"\uD83D\uDEA8";case"high":return"\uD83D\uDD34";case"medium":return"\uD83D\uDFE1";case"low":return"\uD83D\uDFE2";default:return"⚪"}};return(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)(c.Zp,{className:"shadow-lg border-2 ".concat(f.borderColor," ").concat(f.bgColor," transition-all duration-300"),children:[(0,t.jsx)(c.aR,{className:"bg-gradient-to-r ".concat(f.color," text-white rounded-t-lg"),children:(0,t.jsxs)(c.ZB,{className:"text-2xl flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"text-3xl",children:f.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:"Create New Situation"}),(0,t.jsx)("div",{className:"text-sm font-normal opacity-90 mt-1",children:f.description})]})]})}),(0,t.jsx)(c.Wu,{className:"p-6",children:(0,t.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(h.J,{htmlFor:"situationType",className:"text-lg font-semibold",children:"Choose Situation Type"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(g).map(e=>{let[s,r]=e;return(0,t.jsxs)("button",{type:"button",onClick:()=>b(s),className:"p-4 rounded-lg border-2 transition-all duration-200 hover:scale-105 ".concat(p===s?"".concat(r.borderColor," ").concat(r.bgColor," shadow-md"):"border-gray-200 bg-white hover:border-gray-300"),children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:r.icon}),(0,t.jsx)("div",{className:"text-sm font-medium",children:r.label})]},s)})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(h.J,{htmlFor:"title",className:"text-base font-medium",children:"Situation Title"}),(0,t.jsx)(u.p,{id:"title",required:!0,placeholder:"Brief, clear title for the situation",value:j.title,onChange:e=>y(s=>({...s,title:e.target.value})),className:"mt-1 text-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"priority",className:"text-base font-medium",children:"Priority Level"}),(0,t.jsxs)(m.l6,{value:j.priority,onValueChange:e=>y(s=>({...s,priority:e})),children:[(0,t.jsx)(m.bq,{className:"mt-1",children:(0,t.jsx)(m.yv,{})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsxs)(m.eb,{value:"low",children:[w("low")," Low Priority"]}),(0,t.jsxs)(m.eb,{value:"medium",children:[w("medium")," Medium Priority"]}),(0,t.jsxs)(m.eb,{value:"high",children:[w("high")," High Priority"]}),(0,t.jsxs)(m.eb,{value:"urgent",children:[w("urgent")," Urgent"]})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"description",className:"text-base font-medium",children:"Detailed Description"}),(0,t.jsx)(x.T,{id:"description",required:!0,placeholder:"Provide a clear, detailed description of the situation and what needs to be done",value:j.description,onChange:e=>y(s=>({...s,description:e.target.value})),className:"mt-1 min-h-[100px]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"deadline",className:"text-base font-medium",children:"Deadline (Optional)"}),(0,t.jsx)(u.p,{id:"deadline",type:"datetime-local",value:j.deadline,onChange:e=>y(s=>({...s,deadline:e.target.value})),className:"mt-1"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Set a deadline if this situation is time-sensitive"})]}),(()=>{switch(p){case"emergency":return(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("span",{className:"text-red-600 text-lg",children:"⚠️"}),(0,t.jsx)("h4",{className:"font-medium text-red-800",children:"Emergency Details"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"emergencyType",className:"text-red-700",children:"Emergency Type"}),(0,t.jsxs)(m.l6,{onValueChange:e=>D("emergencyType",e),children:[(0,t.jsx)(m.bq,{className:"border-red-300 focus:border-red-500",children:(0,t.jsx)(m.yv,{placeholder:"Select emergency type"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"pickup",children:"\uD83C\uDFEB School/Daycare Pickup"}),(0,t.jsx)(m.eb,{value:"injury",children:"\uD83E\uDE79 Injury/Accident"}),(0,t.jsx)(m.eb,{value:"illness",children:"\uD83E\uDD12 Illness"}),(0,t.jsx)(m.eb,{value:"behavioral",children:"\uD83D\uDE24 Behavioral Emergency"}),(0,t.jsx)(m.eb,{value:"other",children:"❓ Other Emergency"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"urgencyLevel",className:"text-red-700",children:"Urgency Level"}),(0,t.jsxs)(m.l6,{onValueChange:e=>D("urgencyLevel",parseInt(e)),children:[(0,t.jsx)(m.bq,{className:"border-red-300 focus:border-red-500",children:(0,t.jsx)(m.yv,{placeholder:"Select urgency"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"1",children:"\uD83D\uDFE2 1 - Low"}),(0,t.jsx)(m.eb,{value:"2",children:"\uD83D\uDFE1 2 - Moderate"}),(0,t.jsx)(m.eb,{value:"3",children:"\uD83D\uDFE0 3 - High"}),(0,t.jsx)(m.eb,{value:"4",children:"\uD83D\uDD34 4 - Very High"}),(0,t.jsx)(m.eb,{value:"5",children:"\uD83D\uDEA8 5 - Critical"})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"location",className:"text-red-700",children:"Location"}),(0,t.jsx)(u.p,{id:"location",placeholder:"Where is the emergency?",value:j.metadata.location||"",onChange:e=>D("location",e.target.value),className:"border-red-300 focus:border-red-500"})]})]});case"logistics":return(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("span",{className:"text-blue-600 text-lg",children:"\uD83D\uDCE6"}),(0,t.jsx)("h4",{className:"font-medium text-blue-800",children:"Logistics Details"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"logisticsType",className:"text-blue-700",children:"Logistics Type"}),(0,t.jsxs)(m.l6,{onValueChange:e=>D("logisticsType",e),children:[(0,t.jsx)(m.bq,{className:"border-blue-300 focus:border-blue-500",children:(0,t.jsx)(m.yv,{placeholder:"Select logistics type"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"forgotten_item",children:"\uD83C\uDF92 Forgotten Item"}),(0,t.jsx)(m.eb,{value:"schedule_change",children:"\uD83D\uDCC5 Schedule Change"}),(0,t.jsx)(m.eb,{value:"pickup_coordination",children:"\uD83D\uDE97 Pickup Coordination"}),(0,t.jsx)(m.eb,{value:"item_transfer",children:"\uD83D\uDCE6 Item Transfer"}),(0,t.jsx)(m.eb,{value:"other",children:"\uD83D\uDCCB Other"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"items",className:"text-blue-700",children:"Items/Details"}),(0,t.jsx)(x.T,{id:"items",placeholder:"What items or details need coordination?",value:j.metadata.items||"",onChange:e=>D("items",e.target.value),className:"border-blue-300 focus:border-blue-500 min-h-[80px]"})]})]});case"barter":return(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("span",{className:"text-green-600 text-lg",children:"\uD83D\uDD04"}),(0,t.jsx)("h4",{className:"font-medium text-green-800",children:"Trade Details"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"offering",className:"text-green-700",children:"What You're Offering"}),(0,t.jsx)(x.T,{id:"offering",placeholder:"What are you willing to give up or trade?",value:j.metadata.offering||"",onChange:e=>D("offering",e.target.value),className:"border-green-300 focus:border-green-500 min-h-[80px]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"requesting",className:"text-green-700",children:"What You're Requesting"}),(0,t.jsx)(x.T,{id:"requesting",placeholder:"What do you want in return?",value:j.metadata.requesting||"",onChange:e=>D("requesting",e.target.value),className:"border-green-300 focus:border-green-500 min-h-[80px]"})]})]})]});case"behavioral":return(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("span",{className:"text-purple-600 text-lg",children:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66"}),(0,t.jsx)("h4",{className:"font-medium text-purple-800",children:"Behavioral Details"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"behaviorType",className:"text-purple-700",children:"Behavior Type"}),(0,t.jsxs)(m.l6,{onValueChange:e=>D("behaviorType",e),children:[(0,t.jsx)(m.bq,{className:"border-purple-300 focus:border-purple-500",children:(0,t.jsx)(m.yv,{placeholder:"Select behavior type"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"academic",children:"\uD83D\uDCDA Academic Issues"}),(0,t.jsx)(m.eb,{value:"social",children:"\uD83D\uDC6B Social Issues"}),(0,t.jsx)(m.eb,{value:"emotional",children:"\uD83D\uDCAD Emotional Issues"}),(0,t.jsx)(m.eb,{value:"disciplinary",children:"⚖️ Disciplinary Issues"}),(0,t.jsx)(m.eb,{value:"developmental",children:"\uD83C\uDF31 Developmental Concerns"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.J,{htmlFor:"severity",className:"text-purple-700",children:"Severity Level"}),(0,t.jsxs)(m.l6,{onValueChange:e=>D("severity",parseInt(e)),children:[(0,t.jsx)(m.bq,{className:"border-purple-300 focus:border-purple-500",children:(0,t.jsx)(m.yv,{placeholder:"Select severity"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"1",children:"\uD83D\uDFE2 1 - Minor"}),(0,t.jsx)(m.eb,{value:"2",children:"\uD83D\uDFE1 2 - Moderate"}),(0,t.jsx)(m.eb,{value:"3",children:"\uD83D\uDFE0 3 - Significant"}),(0,t.jsx)(m.eb,{value:"4",children:"\uD83D\uDD34 4 - Major"}),(0,t.jsx)(m.eb,{value:"5",children:"\uD83D\uDEA8 5 - Severe"})]})]})]})]})]});default:return null}})(),(0,t.jsx)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:(0,t.jsx)(o.$,{type:"submit",disabled:n||!j.title||!j.description,className:"px-8 py-3 text-lg font-medium transition-all duration-200 ".concat("emergency"===p?"bg-red-600 hover:bg-red-700 text-white shadow-lg hover:shadow-xl":"bg-gradient-to-r ".concat(f.color," text-white shadow-lg hover:shadow-xl hover:scale-105")),children:n?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Creating..."})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{children:f.icon}),(0,t.jsxs)("span",{children:["Create ",f.label]})]})})}),isGuestMode&&(0,t.jsx)("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("span",{className:"text-blue-600 text-xl",children:"\uD83C\uDFAD"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-blue-800",children:"Demo Mode Active"}),(0,t.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"This situation will be created for demonstration purposes. In a real implementation, it would be saved to the database and notifications sent to your co-parent."})]})]})})]})})]})})}var b=r(7122);function j(e){var s,r;let{situation:l,onUpdate:i,isResolved:n=!1}=e,[d,u]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1),h=async e=>{if(!d){u(!0);try{i&&i({status:e})}catch(e){console.error("Error updating situation:",e)}finally{u(!1)}}},g=e=>{let s=Math.floor((new Date().getTime()-e.getTime())/6e4);if(s<1)return"Just now";if(s<60)return"".concat(s,"m ago");let r=Math.floor(s/60);if(r<24)return"".concat(r,"h ago");let t=Math.floor(r/24);return"".concat(t,"d ago")};return(0,t.jsxs)(c.Zp,{className:"hover:shadow-lg transition-shadow ".concat(n?"opacity-75":""),children:[(0,t.jsx)(c.aR,{children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:(e=>{switch(e){case"emergency":return"\uD83D\uDEA8";case"logistics":return"\uD83D\uDCE6";case"barter":return"\uD83D\uDD04";case"behavioral":return"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66";case"administrative":return"\uD83D\uDCCB";default:return"\uD83D\uDCDD"}})(l.type)}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.ZB,{className:"text-lg",children:l.title}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Created ",g(l.createdAt)]}),l.deadline&&(0,t.jsxs)("span",{children:["Deadline: ",new Date(l.deadline).toLocaleDateString()]})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(l.priority)),children:l.priority}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"in-progress":case"acknowledged":return"bg-blue-100 text-blue-800 border-blue-200";case"resolved":return"bg-green-100 text-green-800 border-green-200";case"created":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"escalated":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(l.status)),children:l.status})]})]})}),(0,t.jsx)(c.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Type:"}),(0,t.jsx)("p",{className:"text-gray-600 capitalize",children:l.type})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Created by:"}),(0,t.jsx)("p",{className:"text-gray-600",children:l.createdBy})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Assigned to:"}),(0,t.jsx)("p",{className:"text-gray-600",children:(null==(s=l.assignedTo)?void 0:s.join(", "))||"Unassigned"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Involved:"}),(0,t.jsx)("p",{className:"text-gray-600",children:(null==(r=l.involvedParties)?void 0:r.join(", "))||"None"})]})]}),l.metadata&&Object.keys(l.metadata).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>m(!x),className:"text-blue-600 hover:text-blue-800",children:x?"Hide Details":"Show Details"}),x&&(0,t.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Additional Details:"}),(0,t.jsx)("div",{className:"space-y-1 text-sm",children:Object.entries(l.metadata).map(e=>{let[s,r]=e;return(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("span",{className:"font-medium text-gray-600 capitalize w-24",children:[s.replace(/([A-Z])/g," $1").toLowerCase(),":"]}),(0,t.jsx)("span",{className:"text-gray-700",children:"object"==typeof r?JSON.stringify(r):String(r)})]},s)})})]})]}),l.updates&&l.updates.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Recent Updates:"}),(0,t.jsxs)("div",{className:"space-y-2",children:[l.updates.slice(-3).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-2 p-2 bg-gray-50 rounded",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.content}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[g(e.timestamp)," • ",e.type]})]})]},s)),l.updates.length>3&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["... and ",l.updates.length-3," more updates"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>{alert("Update functionality would open a form to add notes, photos, or status changes.")},disabled:d,children:"Add Update"}),!n&&(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>m(!x),children:"View Details"})]}),!n&&(0,t.jsxs)("div",{className:"flex space-x-2",children:["created"===l.status&&(0,t.jsx)(o.$,{size:"sm",onClick:()=>h("acknowledged"),disabled:d,children:"Acknowledge"}),("acknowledged"===l.status||"created"===l.status)&&(0,t.jsx)(o.$,{size:"sm",onClick:()=>h("in-progress"),disabled:d,children:"Start Progress"}),("in-progress"===l.status||"acknowledged"===l.status)&&(0,t.jsx)(o.$,{size:"sm",onClick:()=>h("resolved"),disabled:d,className:"bg-green-600 hover:bg-green-700 text-white",children:d?"Resolving...":"Resolve"})]})]}),isGuestMode&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,t.jsx)("span",{className:"font-medium",children:"Demo Mode:"})," Status updates and interactions are simulated. In a real implementation, these would sync with your co-parent and send notifications."]})})]})})]})}function y(){let{user:e,isLoading:s,isAuthenticated:r}=(0,l.A)(),u=(0,i.useRouter)(),[x,m]=(0,a.useState)([]),[h,g]=(0,a.useState)(new Map),[y,f]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),[D,w]=(0,a.useState)("all");new n.W,new d.h,(0,a.useEffect)(()=>{s||r||u.push("/login")},[s,r,u]),(0,a.useEffect)(()=>{if(s)return;let e=async()=>{try{r&&m([])}catch(e){console.error("Error loading situations:",e)}finally{f(!1)}};if(!r)return void f(!1);e()},[s,r,e]);let C=(e,s)=>{g(r=>{let t=new Map(r),a=t.get(e)||[];return t.set(e,[...a,s]),t}),"handled"===s.responseType?m(s=>s.map(s=>s.id===e?{...s,status:"resolved"}:s)):"on_way"===s.responseType&&m(s=>s.map(s=>s.id===e?{...s,status:"in-progress"}:s))},k=(e,s)=>{m(r=>r.map(r=>r.id===e?{...r,...s}:r))},S=x.filter(e=>"all"===D||e.type===D),T=S.filter(e=>"resolved"!==e.status&&"cancelled"!==e.status),E=S.filter(e=>"resolved"===e.status||"cancelled"===e.status);return s||y?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading situations..."})]})}):e?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Situation Management"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Manage co-parenting coordination, logistics, and situations"})]}),(0,t.jsx)("div",{className:"flex space-x-3",children:(0,t.jsx)(o.$,{onClick:()=>N(!v),children:v?"Cancel":"+ Create Situation"})})]}),v&&(0,t.jsx)(p,{relationshipId:"user-relationship",currentUserId:"current-user",involvedParties:["current-user","co-parent"],onSituationCreated:e=>{m(s=>[e,...s]),N(!1)}}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"all",label:"All Situations",count:x.length},{key:"logistics",label:"Logistics",count:x.filter(e=>"logistics"===e.type).length},{key:"barter",label:"Barter/Trade",count:x.filter(e=>"barter"===e.type).length},{key:"behavioral",label:"Behavioral",count:x.filter(e=>"behavioral"===e.type).length},{key:"emergency",label:"Emergencies",count:x.filter(e=>"emergency"===e.type).length}].map(e=>(0,t.jsxs)("button",{onClick:()=>w(e.key),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat(D===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.label,e.count>0&&(0,t.jsx)("span",{className:"ml-2 py-0.5 px-2 rounded-full text-xs ".concat(D===e.key?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.count})]},e.key))})}),T.length>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Active Situations (",T.length,")"]}),(0,t.jsx)("div",{className:"space-y-4",children:T.map(e=>(0,t.jsxs)("div",{children:["emergency"===e.type?(0,t.jsx)(b.b,{situation:e,currentUserId:"current-user",onResponseSent:s=>C(e.id,s)}):(0,t.jsx)(j,{situation:e,onUpdate:s=>k(e.id,s)}),h.get(e.id)&&h.get(e.id).length>0&&(0,t.jsxs)(c.Zp,{className:"mt-4 border-l-4 border-l-green-500",children:[(0,t.jsx)(c.aR,{children:(0,t.jsx)(c.ZB,{className:"text-lg",children:"Recent Responses"})}),(0,t.jsx)(c.Wu,{children:(0,t.jsx)("div",{className:"space-y-3",children:h.get(e.id).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-green-50 rounded-lg",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-green-600 text-sm",children:"✓"})})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("span",{className:"font-medium text-green-800",children:["acknowledged"===e.responseType&&"✓ Acknowledged","on_way"===e.responseType&&"\uD83D\uDE97 On My Way","handled"===e.responseType&&"✅ Handled","need_help"===e.responseType&&"\uD83C\uDD98 Need Help","cant_help"===e.responseType&&"❌ Can't Help"]}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:e.timestamp.toLocaleTimeString()})]}),e.message&&(0,t.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:e.message}),e.estimatedArrival&&(0,t.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["ETA: ",e.estimatedArrival.toLocaleTimeString()]})]})]},s))})})]})]},e.id))})]}),E.length>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Resolved Situations (",E.length,")"]}),(0,t.jsx)("div",{className:"space-y-4",children:E.map(e=>(0,t.jsx)(j,{situation:e,onUpdate:s=>k(e.id,s),isResolved:!0},e.id))})]}),0===S.length&&(0,t.jsx)(c.Zp,{children:(0,t.jsxs)(c.Wu,{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:"emergency"===D?(0,t.jsx)("span",{className:"text-4xl",children:"\uD83D\uDEA8"}):"logistics"===D?(0,t.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCE6"}):"barter"===D?(0,t.jsx)("span",{className:"text-4xl",children:"\uD83D\uDD04"}):"behavioral"===D?(0,t.jsx)("span",{className:"text-4xl",children:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66"}):(0,t.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"all"===D?"No Situations Yet":"No ".concat(D," situations")}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"emergency"===D?"Create an emergency situation when urgent coordination is needed.":"logistics"===D?"Track forgotten items, schedule changes, and coordination needs.":"barter"===D?"Propose trades and exchanges with your co-parent.":"behavioral"===D?"Coordinate responses to behavioral situations and maintain consistency.":"Create your first situation to start managing co-parenting coordination."}),(0,t.jsx)("div",{className:"flex justify-center space-x-3",children:(0,t.jsx)(o.$,{onClick:()=>N(!0),children:"+ Create Situation"})})]})})]})})}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[277,982,83,122,441,684,358],()=>s(1851)),_N_E=e.O()}]);