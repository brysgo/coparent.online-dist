(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2523:(e,s,t)=>{"use strict";t.d(s,{p:()=>i});var r=t(5155),a=t(2115),l=t(9434);let i=a.forwardRef((e,s)=>{let{className:t,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",t),ref:s,...i})});i.displayName="Input"},5057:(e,s,t)=>{"use strict";t.d(s,{J:()=>i});var r=t(5155),a=t(2115),l=t(9434);let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("label",{ref:s,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70","text-gray-700",t),...a})});i.displayName="Label"},8360:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var r=t(5155),a=t(3715),l=t(2115),i=t(5695),n=t(6874),d=t.n(n),c=t(285),o=t(6695),x=t(2523),u=t(5057),m=t(8539),h=t(9409),g=t(9657),f=t(3579),b=t(2099);function p(e){let{onSuccess:s}=e,[t,a]=(0,l.useState)(""),[i,n]=(0,l.useState)(""),[d,p]=(0,l.useState)(""),[j,y]=(0,l.useState)([]),[v,w]=(0,l.useState)(!0),{sendInvitation:N,loading:k,error:S,clearError:C}=(0,g._)(),I=(()=>{try{return(0,f.createClientComponentClient)()}catch(e){return(0,b.k)()}})();(0,l.useEffect)(()=>{_()},[]),(0,l.useEffect)(()=>{if(S){let e=setTimeout(()=>{C()},5e3);return()=>clearTimeout(e)}},[S,C]);let _=async()=>{try{let{data:{user:e}}=await I.auth.getUser();if(!e)return;let{data:s,error:t}=await I.from("children").select("id, name").order("name");if(t)throw t;y(s||[])}catch(e){console.error("Failed to load children:",e)}finally{w(!1)}},R=async e=>{e.preventDefault(),t&&i&&await N({invitee_email:t,child_id:i,message:d||void 0})&&(a(""),n(""),p(""),null==s||s())};return v?(0,r.jsx)(o.Zp,{className:"w-full max-w-md",children:(0,r.jsx)(o.Wu,{className:"p-6",children:(0,r.jsx)("div",{className:"text-center",children:"Loading..."})})}):(0,r.jsxs)(o.Zp,{className:"w-full max-w-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsx)(o.ZB,{children:"Invite Co-Parent"})}),(0,r.jsx)(o.Wu,{children:(0,r.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(u.J,{htmlFor:"email",children:"Co-Parent Email"}),(0,r.jsx)(x.p,{id:"email",type:"email",value:t,onChange:e=>a(e.target.value),placeholder:"Enter their email address",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.J,{htmlFor:"child",children:"Child"}),(0,r.jsxs)(h.l6,{id:"child",value:i,onChange:e=>n(e.target.value),required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select a child"}),j.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.J,{htmlFor:"message",children:"Personal Message (Optional)"}),(0,r.jsx)(m.T,{id:"message",value:d,onChange:e=>p(e.target.value),placeholder:"Add a personal message to your invitation...",rows:3})]}),S&&(0,r.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:S})}),(0,r.jsx)(c.$,{type:"submit",disabled:k||!t||!i,className:"w-full",children:k?"Sending Invitation...":"Send Invitation"})]})})]})}var j=t(9454);function y(){let[e,s]=(0,l.useState)(!1),[t,a]=(0,l.useState)([]),[i,n]=(0,l.useState)([]),[d,x]=(0,l.useState)(!0),[u,m]=(0,l.useState)(null),h=(()=>{try{return(0,f.createClientComponentClient)()}catch(e){return(0,b.k)()}})();(0,l.useEffect)(()=>{g()},[]);let g=async()=>{try{x(!0);let{data:{user:e}}=await h.auth.getUser();if(!e)return;let{data:s}=await h.from("users").select("email").eq("id",e.id).single();if(m(s),null==s?void 0:s.email){let[t,r]=await Promise.all([j.n.getInvitations(e.id),j.n.getReceivedInvitations(s.email)]);a(t),n(r)}}catch(e){console.error("Failed to load invitations:",e)}finally{x(!1)}},y=e=>{switch(e){case"pending":return"text-yellow-600 bg-yellow-50";case"accepted":return"text-green-600 bg-green-50";case"rejected":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}};return d?(0,r.jsx)(o.Zp,{children:(0,r.jsx)(o.Wu,{className:"p-6",children:(0,r.jsx)("div",{className:"text-center",children:"Loading invitations..."})})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Co-Parent Connections"}),(0,r.jsx)(c.$,{onClick:()=>s(!0),children:"Invite Co-Parent"})]}),e&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Send Invitation"}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>s(!1),children:"\xd7"})]}),(0,r.jsx)(p,{onSuccess:()=>{s(!1),g()}})]})}),i.length>0&&(0,r.jsxs)(o.Zp,{children:[(0,r.jsx)(o.aR,{children:(0,r.jsx)(o.ZB,{children:"Pending Invitations"})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("div",{className:"space-y-3",children:i.map(e=>{var s,t;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Invitation from ",null==(s=e.users)?void 0:s.full_name]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["To co-parent ",null==(t=e.children)?void 0:t.name]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Expires: ",new Date(e.expires_at).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)(c.$,{size:"sm",onClick:()=>window.location.href="/invite?code=".concat(e.invitation_code),children:"View"})})]},e.id)})})})]}),(0,r.jsxs)(o.Zp,{children:[(0,r.jsx)(o.aR,{children:(0,r.jsx)(o.ZB,{children:"Sent Invitations"})}),(0,r.jsx)(o.Wu,{children:0===t.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("p",{children:"No invitations sent yet."}),(0,r.jsx)("p",{className:"text-sm",children:"Invite your co-parent to start sharing schedules and data."})]}):(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>{var s;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Invited ",e.invitee_email]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["For ",null==(s=e.children)?void 0:s.name]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Sent: ",new Date(e.created_at).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(y(e.status)),children:e.status})})]},e.id)})})})]})]})}function v(){let{user:e,isLoading:s,isAuthenticated:t}=(0,a.As)(),n=(0,i.useRouter)();return((0,l.useEffect)(()=>{s||t||n.push("/login")},[s,t,n]),s)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:["Welcome back, ",e.full_name,"!"]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Here's your co-parenting dashboard. Manage your preferences, schedule, and more."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Preferences"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Set your scheduling preferences and priorities."}),(0,r.jsx)(d(),{href:"/preferences",children:(0,r.jsx)(c.$,{className:"w-full",children:"Manage Preferences"})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Calendar"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"View and manage your custody schedule."}),(0,r.jsx)(d(),{href:"/calendar",children:(0,r.jsx)(c.$,{className:"w-full",children:"View Calendar"})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Inventory"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Track your child's belongings and equipment."}),(0,r.jsx)(d(),{href:"/inventory",children:(0,r.jsx)(c.$,{className:"w-full",children:"Manage Inventory"})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Situations"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Handle special situations and emergencies."}),(0,r.jsx)(d(),{href:"/situations",children:(0,r.jsx)(c.$,{className:"w-full",children:"Manage Situations"})})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Activity"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"border-l-4 border-blue-500 pl-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Welcome to CoParent.Online! Start by setting up your preferences."}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Just now"})]})})]}),(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,r.jsx)(y,{})})]})}):null}},8539:(e,s,t)=>{"use strict";t.d(s,{T:()=>i});var r=t(5155),a=t(2115),l=t(9434);let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white placeholder:text-gray-400 focus-visible:ring-blue-500",t),ref:s,...a})});i.displayName="Textarea"},9240:(e,s,t)=>{Promise.resolve().then(t.bind(t,8360))},9409:(e,s,t)=>{"use strict";t.d(s,{bq:()=>n,eb:()=>o,gC:()=>c,l6:()=>i,yv:()=>d});var r=t(5155),a=t(2115),l=t(9434);let i=a.forwardRef((e,s)=>{let{className:t,children:a,...i}=e;return(0,r.jsx)("select",{className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",t),ref:s,...i,children:a})});i.displayName="Select";let n=a.forwardRef((e,s)=>{let{className:t,children:a,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","border-gray-300 bg-white focus:ring-blue-500",t),...i,children:a})});n.displayName="SelectTrigger";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("span",{ref:s,className:(0,l.cn)("block truncate",t),...a})});d.displayName="SelectValue";let c=a.forwardRef((e,s)=>{let{className:t,children:a,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md","border-gray-200 bg-white shadow-lg",t),...i,children:a})});c.displayName="SelectContent";let o=a.forwardRef((e,s)=>{let{className:t,children:a,value:i,...n}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50","hover:bg-gray-100 focus:bg-gray-100",t),"data-value":i,...n,children:a})});o.displayName="SelectItem"}},e=>{var s=s=>e(e.s=s);e.O(0,[277,982,874,579,715,877,441,684,358],()=>s(9240)),_N_E=e.O()}]);