"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{1589:(e,t,a)=>{a.d(t,{V:()=>r});class i{generateMealResponsibilities(e,t,a,i){let r=[],n=new Date(t);for(;n<=a;){let t=n.toISOString().split("T")[0],a=this.generateMealResponsibilityForDate(e,t,i);a&&r.push(a),n.setDate(n.getDate()+1)}return r}generateMealResponsibilityForDate(e,t,a){let i={},r=e.custom_assignments.filter(e=>e.date===t),n=new Set(r.map(e=>e.meal_type));return(r.forEach(t=>{var a;i[t.meal_type]={responsible_parent_id:t.responsible_parent_id,time:t.time||(null==(a=e.default_assignments[t.meal_type])?void 0:a.time)||this.getDefaultMealTime(t.meal_type),location:t.location,notes:t.notes}}),["breakfast","lunch","dinner"].forEach(r=>{if(!n.has(r)&&e.default_assignments[r]){let n=e.default_assignments[r],s=n.parent_id;if(a){let e=a.find(e=>e.date===t);e&&(s=e.responsible_parent_id)}i[r]={responsible_parent_id:s,time:n.time}}}),0===Object.keys(i).length)?null:{date:t,meals:i}}createMealAssignment(e,t,a,i,r){return{id:"meal-".concat(a,"-").concat(t,"-").concat(Date.now()),relationship_id:e,date:t,meal_type:a,responsible_parent_id:i,time:null==r?void 0:r.time,location:null==r?void 0:r.location,notes:null==r?void 0:r.notes,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}updateMealSchedule(e,t){let a=[...e.custom_assignments];return t.forEach(e=>{let t=a.findIndex(t=>t.date===e.date&&t.meal_type===e.meal_type);-1!==t?a[t]=e:a.push(e)}),{...e,custom_assignments:a,updated_at:new Date().toISOString()}}getMealResponsibility(e,t,a,i){let r=this.generateMealResponsibilityForDate(e,t,i);return(null==r?void 0:r.meals[a])||null}createDefaultMealSchedule(e,t,a){return{id:"meal-schedule-".concat(e),relationship_id:e,default_assignments:{breakfast:{parent_id:t,time:"07:30"},lunch:{parent_id:t,time:"12:00"},dinner:{parent_id:t,time:"18:30"}},custom_assignments:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}getDefaultMealTime(e){switch(e){case"breakfast":return"07:30";case"lunch":default:return"12:00";case"dinner":return"18:30";case"snack":return"15:00"}}}let r=new i},5705:(e,t,a)=>{a.d(t,{guestModeManager:()=>u});var i=a(1589);let r=()=>({currentUser:{id:"demo-user-1",email:"demo.parent1@example.com",full_name:"Alex Johnson",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z",credit_score:100},otherParent:{id:"demo-user-2",email:"demo.parent2@example.com",full_name:"Jordan Smith",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z",credit_score:100}}),n=()=>[{id:"demo-child-1",name:"Emma Johnson-Smith",date_of_birth:"2016-03-15",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-child-2",name:"Liam Johnson-Smith",date_of_birth:"2019-08-22",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],s=(e,t,a)=>({id:"demo-relationship-1",child_id:a,parent_a_id:e,parent_b_id:t,time_ratio:50,preference_ratio:50,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}),o=(e,t,a)=>{let i=[],r=new Date,n=new Date;n.setMonth(n.getMonth()+2);let s=new Date(r),o=t,d=0;for(;s<=n;){d>0&&1===s.getDay()&&(o=o===t?a:t);let r=s.getDay();if(0===r||6===r||o===t&&(1===r||2===r)||o===a&&(4===r||5===r)){let a=new Date(s.getFullYear(),s.getMonth(),s.getDate(),18,0),r=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,8,0);i.push({id:"demo-event-".concat(i.length+1),schedule_id:e,parent_id:o,start_time:a.toISOString(),end_time:r.toISOString(),title:"Custody Time - ".concat(o===t?"Your":"Co-parent's"," Week"),description:"Regular custody schedule",location:o===t?"Your Home":"Co-parent's Home",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"})}if(11===s.getMonth()&&25===s.getDate()){let t=new Date(s.getFullYear(),s.getMonth(),s.getDate(),9,0),r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),20,0);i.push({id:"demo-event-christmas",schedule_id:e,parent_id:a,start_time:t.toISOString(),end_time:r.toISOString(),title:"Christmas Day",description:"Christmas celebration",location:"Co-parent's Home",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"})}s.setDate(s.getDate()+1),1===s.getDay()&&d++}return i},d=(e,t)=>({days:[{id:"demo-day-pref-1",relationship_id:e,parent_id:t,day_of_week:5,priority:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-2",relationship_id:e,parent_id:t,day_of_week:6,priority:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-3",relationship_id:e,parent_id:t,day_of_week:0,priority:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-4",relationship_id:e,parent_id:t,day_of_week:3,priority:4,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-5",relationship_id:e,parent_id:t,day_of_week:4,priority:5,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-6",relationship_id:e,parent_id:t,day_of_week:1,priority:6,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-7",relationship_id:e,parent_id:t,day_of_week:2,priority:7,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],dates:[{id:"demo-date-pref-1",relationship_id:e,parent_id:t,date:"2025-12-25",priority:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-2",relationship_id:e,parent_id:t,date:"2025-07-04",priority:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-3",relationship_id:e,parent_id:t,date:"2025-11-27",priority:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-4",relationship_id:e,parent_id:t,date:"2025-03-15",priority:4,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],handoffTimes:[{id:"demo-handoff-1",relationship_id:e,time:"18:00",priority_parent_a:1,priority_parent_b:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-2",relationship_id:e,time:"12:00",priority_parent_a:2,priority_parent_b:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-3",relationship_id:e,time:"15:00",priority_parent_a:3,priority_parent_b:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-4",relationship_id:e,time:"10:00",priority_parent_a:1,priority_parent_b:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-5",relationship_id:e,time:"14:00",priority_parent_a:2,priority_parent_b:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}]}),l=()=>{let{currentUser:e,otherParent:t}=r(),a=n(),l=s(e.id,t.id,a[0].id),c=o("demo-schedule-1",e.id,t.id),p=d(l.id,e.id),u=i.V.createDefaultMealSchedule(l.id,e.id,t.id);return{currentUser:e,otherParent:t,children:a,relationship:l,scheduleEvents:c,mealSchedule:u,preferences:p}},c=()=>({"2025-01-01":"New Year's Day","2025-02-14":"Valentine's Day","2025-03-15":"Emma's Birthday","2025-03-17":"St. Patrick's Day","2025-04-20":"Easter","2025-05-11":"Mother's Day","2025-06-15":"Father's Day","2025-07-04":"Independence Day","2025-08-22":"Liam's Birthday","2025-09-01":"Labor Day","2025-10-31":"Halloween","2025-11-27":"Thanksgiving","2025-12-25":"Christmas Day","2025-12-31":"New Year's Eve"});class p{generateDemoData(){return l()}getGuestData(){return this.currentSession?this.currentSession.demoData:null}getHolidayData(){return c()}saveGuestInteraction(e,t,a){if(this.currentSession||this.loadOrCreateSession(),!this.currentSession)return void console.warn("Failed to create guest session");let i={id:"interaction-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,timestamp:new Date,data:t,metadata:a};this.currentSession.interactions.push(i),this.currentSession.lastActivity=new Date,this.currentSession.interactions.length>100&&(this.currentSession.interactions=this.currentSession.interactions.slice(-50)),this.saveSession()}updateGuestPreferences(e,t){this.currentSession&&(this.currentSession.demoData.preferences[e]=t,this.saveGuestInteraction("preference_sort",{type:e,preferences:t}),this.saveSession())}getSessionAnalytics(){let e;if(!this.currentSession)return{sessionDuration:0,interactionCount:0,featuresUsed:[],sortingCompleted:!1,engagementScore:0};let t=Date.now()-this.currentSession.startTime.getTime(),a=this.currentSession.interactions.length,i=[...new Set(this.currentSession.interactions.map(e=>e.type))],r=this.currentSession.interactions.some(e=>"preference_sort"===e.type);return e=0+30*Math.min(t/3e5,1)+40*Math.min(a/10,1)+5*i.length+20*!!r,{sessionDuration:t,interactionCount:a,featuresUsed:i,sortingCompleted:r,engagementScore:Math.min(e,100)}}exportGuestDataForSignup(){return this.currentSession?{preferences:this.currentSession.demoData.preferences}:null}clearGuestData(){try{localStorage.removeItem(p.STORAGE_KEY),this.currentSession=null}catch(e){console.warn("Failed to clear guest data:",e)}}isGuestMode(){return null!==this.currentSession}getSessionId(){var e;return(null==(e=this.currentSession)?void 0:e.sessionId)||null}updateSessionPreferences(e){this.currentSession&&(this.currentSession.preferences={...this.currentSession.preferences,...e},this.saveSession())}loadOrCreateSession(){try{let e=localStorage.getItem(p.STORAGE_KEY);if(e){let t=JSON.parse(e),a=new Date(t.lastActivity);if(!(Date.now()-a.getTime()>p.SESSION_TIMEOUT)){t.startTime=new Date(t.startTime),t.lastActivity=new Date(t.lastActivity),t.interactions=t.interactions.map(e=>({...e,timestamp:new Date(e.timestamp)})),this.currentSession=t;return}}}catch(e){console.warn("Failed to load guest session:",e)}this.createNewSession()}createNewSession(){let e="guest-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9));this.currentSession={sessionId:e,startTime:new Date,lastActivity:new Date,interactions:[],demoData:this.generateDemoData(),preferences:{completedTutorial:!1,skipTour:!1,preferredFeatures:[]}},this.saveSession()}saveSession(){if(this.currentSession)try{let e=JSON.stringify(this.currentSession);if(e.length>p.MAX_STORAGE_SIZE){console.warn("Guest session data too large, trimming interactions"),this.currentSession.interactions=this.currentSession.interactions.slice(-20),this.saveSession();return}localStorage.setItem(p.STORAGE_KEY,e)}catch(e){e instanceof DOMException&&22===e.code?(console.warn("localStorage quota exceeded, clearing old guest data"),this.clearGuestData(),this.createNewSession()):console.error("Failed to save guest session:",e)}}getConversionReadiness(){let e=this.getSessionAnalytics(),t={timeSpent:25*Math.min(e.sessionDuration/6e5,1),featuresExplored:25*Math.min(e.featuresUsed.length/3,1),sortingCompleted:25*!!e.sortingCompleted,engagementLevel:.25*e.engagementScore},a=Object.values(t).reduce((e,t)=>e+t,0),i=[];return t.timeSpent<15&&i.push("Encourage more exploration"),t.featuresExplored<15&&i.push("Show additional features"),e.sortingCompleted||i.push("Guide to sorting feature"),a>70&&i.push("Show conversion prompt"),{score:a,factors:t,recommendations:i}}constructor(){this.currentSession=null,this.loadOrCreateSession()}}p.STORAGE_KEY="coparent_guest_session",p.MAX_STORAGE_SIZE=5242880,p.SESSION_TIMEOUT=864e5;let u=new p}}]);