(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{396:(e,s,n)=>{Promise.resolve().then(n.bind(n,9331))},844:(e,s,n)=>{"use strict";n.d(s,{GY:()=>l,h9:()=>t,hV:()=>c});var i=n(9509);function a(){let e="main";return"production"}function t(){if("production"===a())return{url:"https://gjgldkinpnckfwzwdbmt.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2xka2lucG5ja2Z3endkYm10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0OTczMDYsImV4cCI6MjA2NzA3MzMwNn0.5ZQourcUdjk19MWjLQ9O0VhcHJj09YPzcxbN35MfMtQ",serviceRoleKey:i.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"};{let e=i.env.NEXT_PUBLIC_SUPABASE_DEV_URL||i.env.SUPABASE_DEV_URL||"https://bqiapoplmkkrtnsmmxhs.supabase.co";return{url:e,anonKey:i.env.NEXT_PUBLIC_SUPABASE_DEV_ANON_KEY||i.env.SUPABASE_DEV_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NDA3OTMsImV4cCI6MjA2ODAxNjc5M30.bZGNGvb8XYZSWkbfMYMNBAzoedp4SGOIerHmNcRqUsk",serviceRoleKey:i.env.SUPABASE_DEV_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ0MDc5MywiZXhwIjoyMDY4MDE2NzkzfQ.7m9y2vqrq1Sd8bX6dl6A47WQbZoQHGKc7o2rzrcTjKI"}}}function c(e){return"https://placeholder.supabase.co"!==e.url&&"placeholder-anon-key"!==e.anonKey&&(e.url.includes("supabase.co")||e.url.includes("127.0.0.1"))}function l(){let e=a(),s=t(),n=c(s);return{currentBranch:"main",environment:e,supabaseUrl:s.url,hasValidConfig:n,configSource:"production"===e?"production":i.env.NEXT_PUBLIC_SUPABASE_DEV_URL?"development-env-vars":"development-default"}}},2099:(e,s,n)=>{"use strict";n.d(s,{k:()=>c});var i=n(4982),a=n(844);let t=null,c=()=>{if(t)return t;let e=(0,a.h9)();return t=(0,a.hV)(e)?(0,i.UU)(e.url,e.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}}):(0,i.UU)("https://placeholder.supabase.co","placeholder-anon-key",{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}})}},9331:(e,s,n)=>{"use strict";n.d(s,{InvitationAcceptance:()=>o});var i=n(5155),a=n(2115),t=n(5695),c=n(285),l=n(6695),r=n(9657),d=n(2099);function o(){let[e,s]=(0,a.useState)(null),[n,o]=(0,a.useState)(!0),[u,h]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),{acceptInvitation:p,rejectInvitation:j,loading:v,error:I}=(0,r._)(),N=(0,d.k)(),f=(0,t.useRouter)(),y=(0,t.useSearchParams)().get("code");(0,a.useEffect)(()=>{_(),y&&b()},[y]);let _=async()=>{let{data:{user:e}}=await N.auth.getUser();h(!!e)},b=async()=>{if(!y){x("No invitation code provided"),o(!1);return}try{let{data:e,error:n}=await N.from("co_parent_invitations").select("\n          *,\n          children(name),\n          users!inviter_id(full_name, email)\n        ").eq("invitation_code",y).eq("status","pending").single();if(n||!e)return void x("Invitation not found or has already been processed");if(new Date(e.expires_at)<new Date)return void x("This invitation has expired");s(e)}catch(e){x("Failed to load invitation details")}finally{o(!1)}},S=async()=>{y&&await p(y)&&f.push("/dashboard?invitation_accepted=true")},g=async()=>{y&&await j(y)&&f.push("/")};return n?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(l.Zp,{className:"w-full max-w-md",children:(0,i.jsx)(l.Wu,{className:"p-6",children:(0,i.jsx)("div",{className:"text-center",children:"Loading invitation..."})})})}):m||!e?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{className:"text-red-600",children:"Invitation Error"})}),(0,i.jsxs)(l.Wu,{children:[(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:m||"Invalid invitation"}),(0,i.jsx)(c.$,{onClick:()=>f.push("/"),className:"w-full",children:"Go to Homepage"})]})]})}):u?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{children:"Accept Co-Parent Invitation"})}),(0,i.jsx)(l.Wu,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("p",{className:"text-lg font-medium mb-2",children:[e.users.full_name," has invited you"]}),(0,i.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,i.jsx)("strong",{children:e.children.name})]})]}),I&&(0,i.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,i.jsx)("p",{className:"text-sm text-red-600",children:I})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.$,{onClick:S,disabled:v,className:"w-full",children:v?"Processing...":"Accept Invitation"}),(0,i.jsx)(c.$,{onClick:g,variant:"outline",disabled:v,className:"w-full",children:"Decline Invitation"})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["By accepting, you agree to share custody information for"," ",e.children.name," with ",e.users.full_name,"."]})]})})]})}):(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)(l.Zp,{className:"w-full max-w-md",children:[(0,i.jsx)(l.aR,{children:(0,i.jsx)(l.ZB,{children:"Co-Parent Invitation"})}),(0,i.jsx)(l.Wu,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("p",{className:"text-lg font-medium mb-2",children:["You've been invited by ",e.users.full_name]}),(0,i.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,i.jsx)("strong",{children:e.children.name})]})]}),(0,i.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,i.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Benefits of joining:"}),(0,i.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,i.jsx)("li",{children:"• Share schedules and coordinate custody"}),(0,i.jsx)("li",{children:"• Track shared expenses and manage finances"}),(0,i.jsx)("li",{children:"• Manage children's inventory and belongings"}),(0,i.jsx)("li",{children:"• Communicate effectively through the platform"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.$,{onClick:()=>{f.push("/signup?invitation_code=".concat(y))},className:"w-full",children:"Create Account & Accept"}),(0,i.jsx)(c.$,{onClick:()=>{f.push("/login?invitation_code=".concat(y))},variant:"outline",className:"w-full",children:"I already have an account"})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["This invitation expires on"," ",new Date(e.expires_at).toLocaleDateString()]})]})})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[277,982,877,441,684,358],()=>s(396)),_N_E=e.O()}]);