(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[259,883],{2047:(e,r,t)=>{"use strict";t.d(r,{k:()=>l,H:()=>c});var n=t(4982),s=t(9509);function a(){let e=function(){if(void 0!==s&&s.env){if(s.env.GITHUB_HEAD_REF)return s.env.GITHUB_HEAD_REF;if(s.env.GITHUB_REF)return s.env.GITHUB_REF.replace("refs/heads/","");if(s.env.VERCEL_GIT_COMMIT_REF)return s.env.VERCEL_GIT_COMMIT_REF;if(s.env.BRANCH)return s.env.BRANCH}return"main"}();if("main"===e||"master"===e||"production"===e)return{url:"https://gjgldkinpnckfwzwdbmt.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2xka2lucG5ja2Z3endkYm10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0OTczMDYsImV4cCI6MjA2NzA3MzMwNn0.5ZQourcUdjk19MWjLQ9O0VhcHJj09YPzcxbN35MfMtQ",serviceRoleKey:s.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"};let r=e.replace(/[^a-zA-Z0-9]/g,"_").toUpperCase(),t=s.env["NEXT_PUBLIC_SUPABASE_URL_".concat(r)]||s.env["SUPABASE_URL_".concat(r)],n=s.env["NEXT_PUBLIC_SUPABASE_ANON_KEY_".concat(r)]||s.env["SUPABASE_ANON_KEY_".concat(r)],a=s.env["SUPABASE_SERVICE_ROLE_KEY_".concat(r)];if(t&&n)return{url:t,anonKey:n,serviceRoleKey:a||"placeholder-service-role-key"};let i=s.env.NEXT_PUBLIC_SUPABASE_PREVIEW_URL||s.env.SUPABASE_PREVIEW_URL,l=s.env.NEXT_PUBLIC_SUPABASE_PREVIEW_ANON_KEY||s.env.SUPABASE_PREVIEW_ANON_KEY,c=s.env.SUPABASE_PREVIEW_SERVICE_ROLE_KEY;return i&&l?{url:i,anonKey:l,serviceRoleKey:c||"placeholder-service-role-key"}:{url:"https://gjgldkinpnckfwzwdbmt.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2xka2lucG5ja2Z3endkYm10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0OTczMDYsImV4cCI6MjA2NzA3MzMwNn0.5ZQourcUdjk19MWjLQ9O0VhcHJj09YPzcxbN35MfMtQ",serviceRoleKey:s.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"}}function i(e){return"https://placeholder.supabase.co"!==e.url&&"placeholder-anon-key"!==e.anonKey&&e.url.includes("supabase.co")}let l=()=>{let e=a();return i(e)?(0,n.UU)(e.url,e.anonKey):(0,n.UU)("https://placeholder.supabase.co","placeholder-anon-key")},c=()=>{let e=a();return i(e)&&e.serviceRoleKey&&"placeholder-service-role-key"!==e.serviceRoleKey?(0,n.UU)(e.url,e.serviceRoleKey,{auth:{autoRefreshToken:!1,persistSession:!1}}):(0,n.UU)("https://placeholder.supabase.co","placeholder-service-role-key",{auth:{autoRefreshToken:!1,persistSession:!1}})}},4906:(e,r,t)=>{Promise.resolve().then(t.bind(t,5034))},5034:(e,r,t)=>{"use strict";t.d(r,{DayPreferenceSorting:()=>c});var n=t(5155),s=t(2115),a=t(4110),i=t(2047);let l=[{id:"0",label:"Sunday",description:"Weekend day"},{id:"1",label:"Monday",description:"Start of school week"},{id:"2",label:"Tuesday",description:"School day"},{id:"3",label:"Wednesday",description:"Mid-week"},{id:"4",label:"Thursday",description:"School day"},{id:"5",label:"Friday",description:"End of school week"},{id:"6",label:"Saturday",description:"Weekend day"}];function c(e){let{relationshipId:r,currentUserId:t,existingPreferences:c=[],otherParentPreferences:o=[]}=e,[d,p]=(0,s.useState)(l),[u,y]=(0,s.useState)(!1),[h,E]=(0,s.useState)(null),[_,f]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(c.length>0){let e=[...c].sort((e,r)=>e.priority-r.priority),r=e.map(e=>l.find(r=>parseInt(r.id)===e.dayOfWeek)),t=new Set(e.map(e=>e.dayOfWeek.toString()));p([...r,...l.filter(e=>!t.has(e.id))])}},[c]);let I=async e=>{y(!0),E(null);try{let n=(0,i.k)(),s=e.map((e,n)=>({relationshipId:r,userId:t,dayOfWeek:parseInt(e.id),priority:n+1})),{error:a}=await n.from("day_preferences").upsert(s);if(a)throw a;p(e)}catch(e){E("Error saving preferences. Please try again."),console.error("Error saving day preferences:",e)}finally{y(!1)}};return(0,n.jsxs)("div",{className:"space-y-6","data-testid":"day-preferences",children:[o.length>0&&(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Other Parent's Preferences"}),(0,n.jsx)("button",{onClick:()=>f(!_),className:"text-blue-600 hover:text-blue-800 text-sm",children:_?"Hide":"Show"})]}),_&&(0,n.jsx)("div",{className:"space-y-2",children:o.sort((e,r)=>e.priority-r.priority).map((e,r)=>{let t=l.find(r=>parseInt(r.id)===e.dayOfWeek);return(0,n.jsxs)("div",{className:"flex items-center text-sm",children:[(0,n.jsx)("span",{className:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center text-xs mr-3",children:r+1}),(0,n.jsx)("span",{children:null==t?void 0:t.label})]},e.dayOfWeek)})})]}),h&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,n.jsx)("p",{className:"text-red-800",children:h})}),u&&(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("p",{className:"text-gray-600",children:"Saving your preferences..."})}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("button",{"data-testid":"sort-day-preferences",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",onClick:()=>{let e=document.querySelector('[data-testid="sorting-component"]');e&&e.scrollIntoView({behavior:"smooth"})},children:"Start Sorting Day Preferences"})}),(0,n.jsx)(a.S,{items:d,onSortComplete:I,title:"Sort Your Day Preferences",description:"Rank the days of the week by your preference to have your child. Most preferred days will be ranked higher."})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[212,982,796,110,441,684,358],()=>r(4906)),_N_E=e.O()}]);