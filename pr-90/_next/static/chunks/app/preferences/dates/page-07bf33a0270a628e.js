(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[681],{266:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5155),a=s(2115),n=s(4110),l=s(285),i=s(6695);function o(e){let{selectedDates:t,onDatesChange:s,onStartSorting:n,holidayData:o={}}=e,[c,d]=(0,a.useState)(""),h=e=>{let r=new Date;if(r.setHours(0,0,0,0),e<r)return;let a=e.toISOString().split("T")[0];t.map(e=>e.toISOString().split("T")[0]).includes(a)||s([...t,e])},m=e=>{s(t.filter(t=>t.toISOString()!==e.toISOString()))},u=e=>{let t=o[e.toISOString().split("T")[0]];return t?"".concat(t," (").concat(e.toLocaleDateString(),")"):e.toLocaleDateString()},p=[{date:new Date("2024-12-25"),label:"Christmas Day"},{date:new Date("2024-01-01"),label:"New Year's Day"},{date:new Date("2024-07-04"),label:"Independence Day"},{date:new Date("2024-11-28"),label:"Thanksgiving"},{date:new Date("2024-10-31"),label:"Halloween"},{date:new Date("2024-02-14"),label:"Valentine's Day"}].filter(e=>{let t=new Date;return t.setHours(0,0,0,0),e.date>=t});return(0,r.jsxs)(i.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Select Important Dates"}),(0,r.jsx)(i.BT,{children:"Choose the dates that are most important to you for having your child. You'll then sort them by priority."})]}),(0,r.jsxs)(i.Wu,{className:"space-y-6",children:[t.length>0&&(0,r.jsxs)("div",{"data-testid":"selected-dates",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium mb-2",children:["Selected Dates (",t.length,")"]}),(0,r.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,r.jsxs)("div",{"data-testid":"selected-".concat(e.toISOString()),className:"flex items-center justify-between p-2 bg-blue-50 rounded-md",children:[(0,r.jsx)("span",{className:"text-sm",children:u(e)}),(0,r.jsx)(l.$,{variant:"ghost",size:"sm",onClick:()=>m(e),className:"text-red-600 hover:text-red-800",children:"Remove"})]},e.toISOString()))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Common Important Dates"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:p.map(e=>{let s=t.some(t=>t.toISOString().split("T")[0]===e.date.toISOString().split("T")[0]);return(0,r.jsx)(l.$,{variant:s?"secondary":"outline",size:"sm",onClick:()=>h(e.date),disabled:s,className:"text-xs",children:e.label},e.date.toISOString())})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Add Custom Date"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"date",value:c,onChange:e=>d(e.target.value),min:new Date().toISOString().split("T")[0],className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,r.jsx)(l.$,{onClick:()=>{c&&(h(new Date(c)),d(""))},disabled:!c,size:"sm",children:"Add Date"})]})]}),(0,r.jsxs)("div",{className:"pt-4 border-t",children:[(0,r.jsx)(l.$,{"data-testid":"start-sorting",onClick:n,disabled:t.length<2,className:"w-full",size:"lg",children:t.length<2?"Select at least 2 dates to start sorting (".concat(t.length,"/2)"):"Start Sorting ".concat(t.length," Dates")}),t.length>=2&&(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-2 text-center",children:"You'll compare dates to determine which are most important to you"})]})]})]})}var c=s(2099);function d(e){let{relationshipId:t,currentUserId:s,selectedDates:l=[],existingPreferences:i=[],holidayData:d={}}=e,[h,m]=(0,a.useState)(l),[u,p]=(0,a.useState)(!1),[x,y]=(0,a.useState)(!1),[g,b]=(0,a.useState)(null),S=(0,c.k)(),f=e=>{let t=new Date;return t.setHours(0,0,0,0),e.filter(e=>{let s=new Date(e);return s.setHours(0,0,0,0),s>=t})},v=async e=>{y(!0),b(null);try{let r=e.map((e,r)=>({relationshipId:t,userId:s,date:e.id,priority:r+1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})),{error:a}=await S.from("date_preferences").upsert(r);if(a)throw a;p(!1)}catch(e){b("Error saving preferences. Please try again."),console.error("Error saving date preferences:",e)}finally{y(!1)}},N=()=>{p(!1)};if(u){let e=(e=>{let t=f(e).map(e=>{let t=e.toISOString().split("T")[0],s=d[t];return{id:t,label:s||e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),description:s?e.toLocaleDateString():void 0,metadata:{date:t,isHoliday:!!s}}});if(i.length>0){let e=new Map(i.map(e=>[e.date,e.priority]));t.sort((t,s)=>(e.get(t.id)||999)-(e.get(s.id)||999))}return t})(h);return e.length<2?(0,r.jsxs)("div",{className:"text-center p-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"No Future Dates to Sort"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"All selected dates are in the past. Please select future dates to sort."}),(0,r.jsx)("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Back to Date Selection"})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[g&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:g}),(0,r.jsx)(n.S,{items:e,onSortComplete:v,title:"Sort Your Date Preferences",description:"Compare pairs of dates to determine which are most important to you for having your child."}),x&&(0,r.jsx)("div",{className:"text-center py-4",children:(0,r.jsxs)("div",{className:"inline-flex items-center px-4 py-2 font-semibold leading-6 text-sm shadow rounded-md text-white bg-blue-500",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving preferences..."]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{onClick:N,className:"text-blue-600 hover:text-blue-800 text-sm",disabled:x,children:"â† Back to Date Selection"})})]})}return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Date Preference Sorting"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Select important dates and sort them by priority to help with custody scheduling."})]}),(0,r.jsx)(o,{selectedDates:h,onDatesChange:m,onStartSorting:()=>{p(!0)},holidayData:d}),i.length>0&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Your Current Preferences"}),(0,r.jsx)("div",{className:"space-y-1",children:i.sort((e,t)=>e.priority-t.priority).map((e,t)=>{let s=d[e.date],a=new Date(e.date),n=s||a.toLocaleDateString();return(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[t+1,". ",n]},e.date)})})]})]})}function h(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)({}),[l,i]=(0,a.useState)(!0),[o,h]=(0,a.useState)(null),m=(0,c.k)(),u="rel-123",p="user-123";(0,a.useEffect)(()=>{x(),y()},[]);let x=async()=>{try{let{data:e,error:s}=await m.from("date_preferences").select("*").eq("relationshipId",u).eq("userId",p).order("priority",{ascending:!0});if(s)throw s;t(e||[])}catch(e){console.error("Error loading existing preferences:",e),h("Failed to load existing preferences")}},y=async()=>{n({"2024-01-01":"New Year's Day","2024-02-14":"Valentine's Day","2024-03-17":"St. Patrick's Day","2024-04-01":"Easter","2024-05-12":"Mother's Day","2024-06-16":"Father's Day","2024-07-04":"Independence Day","2024-09-02":"Labor Day","2024-10-31":"Halloween","2024-11-28":"Thanksgiving","2024-12-25":"Christmas Day","2024-12-31":"New Year's Eve","2025-01-01":"New Year's Day","2025-02-14":"Valentine's Day","2025-03-17":"St. Patrick's Day","2025-04-20":"Easter","2025-05-11":"Mother's Day","2025-06-15":"Father's Day","2025-07-04":"Independence Day","2025-09-01":"Labor Day","2025-10-31":"Halloween","2025-11-27":"Thanksgiving","2025-12-25":"Christmas Day","2025-12-31":"New Year's Eve"}),i(!1)};return l?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading your date preferences..."})]})}):o?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-md",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Error Loading Preferences"}),(0,r.jsx)("p",{children:o}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Try Again"})]})})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsx)(d,{relationshipId:u,currentUserId:p,selectedDates:e.map(e=>new Date(e.date)),existingPreferences:e,holidayData:s})})})}},844:(e,t,s)=>{"use strict";s.d(t,{GY:()=>o,h9:()=>l,hV:()=>i});var r=s(9509);function a(){let e=n();return"main"===e||"master"===e||"production"===e?"production":"development"}function n(){return"copilot/fix-79"}function l(){if("production"===a())return{url:"https://placeholder.supabase.co",anonKey:"placeholder-anon-key",serviceRoleKey:r.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"};{let e=r.env.SUPABASE_DEV_URL||"https://bqiapoplmkkrtnsmmxhs.supabase.co";return{url:e,anonKey:r.env.SUPABASE_DEV_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NDA3OTMsImV4cCI6MjA2ODAxNjc5M30.bZGNGvb8XYZSWkbfMYMNBAzoedp4SGOIerHmNcRqUsk",serviceRoleKey:r.env.SUPABASE_DEV_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ0MDc5MywiZXhwIjoyMDY4MDE2NzkzfQ.7m9y2vqrq1Sd8bX6dl6A47WQbZoQHGKc7o2rzrcTjKI"}}}function i(e){return"https://placeholder.supabase.co"!==e.url&&"placeholder-anon-key"!==e.anonKey&&e.url.includes("supabase.co")}function o(){let e=n(),t=a(),s=l(),r=i(s);return{currentBranch:e,environment:t,supabaseUrl:s.url,hasValidConfig:r,configSource:"production"===t?"production":"development-default"}}},2099:(e,t,s)=>{"use strict";s.d(t,{H:()=>i,k:()=>l});var r=s(4982),a=s(844);let n=null,l=()=>{if(n)return n;let e=(0,a.h9)();return n=(0,a.hV)(e)?(0,r.UU)(e.url,e.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}}):(0,r.UU)("https://placeholder.supabase.co","placeholder-anon-key",{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}})},i=()=>{let e=(0,a.h9)();return(0,a.hV)(e)&&e.serviceRoleKey&&"placeholder-service-role-key"!==e.serviceRoleKey?(0,r.UU)(e.url,e.serviceRoleKey,{auth:{autoRefreshToken:!1,persistSession:!1}}):(0,r.UU)("https://placeholder.supabase.co","placeholder-service-role-key",{auth:{autoRefreshToken:!1,persistSession:!1}})}},2706:(e,t,s)=>{Promise.resolve().then(s.bind(s,266))}},e=>{var t=t=>e(e.s=t);e.O(0,[277,982,804,796,110,441,684,358],()=>t(2706)),_N_E=e.O()}]);