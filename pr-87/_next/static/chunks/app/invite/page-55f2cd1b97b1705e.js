(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{396:(e,s,n)=>{Promise.resolve().then(n.bind(n,9331))},844:(e,s,n)=>{"use strict";n.d(s,{GY:()=>l,h9:()=>c,hV:()=>r});var t=n(9509);function i(){let e=a();return"main"===e||"master"===e||"production"===e?"production":"development"}function a(){return"copilot/fix-86"}function c(){if("production"===i())return{url:"https://placeholder.supabase.co",anonKey:"placeholder-anon-key",serviceRoleKey:t.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder-service-role-key"};{let e=t.env.SUPABASE_DEV_URL||"https://bqiapoplmkkrtnsmmxhs.supabase.co";return{url:e,anonKey:t.env.SUPABASE_DEV_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NDA3OTMsImV4cCI6MjA2ODAxNjc5M30.bZGNGvb8XYZSWkbfMYMNBAzoedp4SGOIerHmNcRqUsk",serviceRoleKey:t.env.SUPABASE_DEV_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxaWFwb3BsbWtrcnRuc21teGhzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ0MDc5MywiZXhwIjoyMDY4MDE2NzkzfQ.7m9y2vqrq1Sd8bX6dl6A47WQbZoQHGKc7o2rzrcTjKI"}}}function r(e){return"https://placeholder.supabase.co"!==e.url&&"placeholder-anon-key"!==e.anonKey&&e.url.includes("supabase.co")}function l(){let e=a(),s=i(),n=c(),t=r(n);return{currentBranch:e,environment:s,supabaseUrl:n.url,hasValidConfig:t,configSource:"production"===s?"production":"development-default"}}},2099:(e,s,n)=>{"use strict";n.d(s,{H:()=>r,k:()=>c});var t=n(4982),i=n(844);let a=null,c=()=>{if(a)return a;let e=(0,i.h9)();return a=(0,i.hV)(e)?(0,t.UU)(e.url,e.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}}):(0,t.UU)("https://placeholder.supabase.co","placeholder-anon-key",{auth:{autoRefreshToken:!0,persistSession:!0,storage:window.localStorage,detectSessionInUrl:!0}})},r=()=>{let e=(0,i.h9)();return(0,i.hV)(e)&&e.serviceRoleKey&&"placeholder-service-role-key"!==e.serviceRoleKey?(0,t.UU)(e.url,e.serviceRoleKey,{auth:{autoRefreshToken:!1,persistSession:!1}}):(0,t.UU)("https://placeholder.supabase.co","placeholder-service-role-key",{auth:{autoRefreshToken:!1,persistSession:!1}})}},9331:(e,s,n)=>{"use strict";n.d(s,{InvitationAcceptance:()=>u});var t=n(5155),i=n(2115),a=n(5695),c=n(285),r=n(6695),l=n(9657),o=n(3579),d=n(2099);function u(){let[e,s]=(0,i.useState)(null),[n,u]=(0,i.useState)(!0),[h,m]=(0,i.useState)(!1),[p,x]=(0,i.useState)(null),{acceptInvitation:v,rejectInvitation:f,loading:j,error:y}=(0,l._)(),N=(()=>{try{return(0,o.createClientComponentClient)()}catch(e){return(0,d.k)()}})(),I=(0,a.useRouter)(),b=(0,a.useSearchParams)().get("code");(0,i.useEffect)(()=>{g(),b&&S()},[b]);let g=async()=>{let{data:{user:e}}=await N.auth.getUser();m(!!e)},S=async()=>{if(!b){x("No invitation code provided"),u(!1);return}try{let{data:e,error:n}=await N.from("co_parent_invitations").select("\n          *,\n          children(name),\n          users!inviter_id(full_name, email)\n        ").eq("invitation_code",b).eq("status","pending").single();if(n||!e)return void x("Invitation not found or has already been processed");if(new Date(e.expires_at)<new Date)return void x("This invitation has expired");s(e)}catch(e){x("Failed to load invitation details")}finally{u(!1)}},w=async()=>{b&&await v(b)&&I.push("/dashboard?invitation_accepted=true")},_=async()=>{b&&await f(b)&&I.push("/")};return n?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(r.Zp,{className:"w-full max-w-md",children:(0,t.jsx)(r.Wu,{className:"p-6",children:(0,t.jsx)("div",{className:"text-center",children:"Loading invitation..."})})})}):p||!e?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)(r.Zp,{className:"w-full max-w-md",children:[(0,t.jsx)(r.aR,{children:(0,t.jsx)(r.ZB,{className:"text-red-600",children:"Invitation Error"})}),(0,t.jsxs)(r.Wu,{children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:p||"Invalid invitation"}),(0,t.jsx)(c.$,{onClick:()=>I.push("/"),className:"w-full",children:"Go to Homepage"})]})]})}):h?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)(r.Zp,{className:"w-full max-w-md",children:[(0,t.jsx)(r.aR,{children:(0,t.jsx)(r.ZB,{children:"Accept Co-Parent Invitation"})}),(0,t.jsx)(r.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("p",{className:"text-lg font-medium mb-2",children:[e.users.full_name," has invited you"]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,t.jsx)("strong",{children:e.children.name})]})]}),y&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,t.jsx)("p",{className:"text-sm text-red-600",children:y})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.$,{onClick:w,disabled:j,className:"w-full",children:j?"Processing...":"Accept Invitation"}),(0,t.jsx)(c.$,{onClick:_,variant:"outline",disabled:j,className:"w-full",children:"Decline Invitation"})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["By accepting, you agree to share custody information for"," ",e.children.name," with ",e.users.full_name,"."]})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)(r.Zp,{className:"w-full max-w-md",children:[(0,t.jsx)(r.aR,{children:(0,t.jsx)(r.ZB,{children:"Co-Parent Invitation"})}),(0,t.jsx)(r.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("p",{className:"text-lg font-medium mb-2",children:["You've been invited by ",e.users.full_name]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["to co-parent ",(0,t.jsx)("strong",{children:e.children.name})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Benefits of joining:"}),(0,t.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,t.jsx)("li",{children:"• Share schedules and coordinate custody"}),(0,t.jsx)("li",{children:"• Track shared expenses and manage finances"}),(0,t.jsx)("li",{children:"• Manage children's inventory and belongings"}),(0,t.jsx)("li",{children:"• Communicate effectively through the platform"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.$,{onClick:()=>{I.push("/signup?invitation_code=".concat(b))},className:"w-full",children:"Create Account & Accept"}),(0,t.jsx)(c.$,{onClick:()=>{I.push("/login?invitation_code=".concat(b))},variant:"outline",className:"w-full",children:"I already have an account"})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["This invitation expires on"," ",new Date(e.expires_at).toLocaleDateString()]})]})})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[277,982,579,877,441,684,358],()=>s(396)),_N_E=e.O()}]);