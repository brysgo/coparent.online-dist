"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{285:(e,t,a)=>{a.d(t,{$:()=>c});var i=a(5155),s=a(2115),n=a(4624),r=a(2085),o=a(9434);let d=(0,r.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,size:r,asChild:c=!1,...l}=e,u=c?n.DX:"button";return(0,i.jsx)(u,{className:(0,o.cn)(d({variant:s,size:r,className:a})),ref:t,...l})});c.displayName="Button"},3382:(e,t,a)=>{a.d(t,{W:()=>i});class i{async createSituation(e){let t=this.generateId(),a=new Date,i=this.getTemplate(e.type),s=this.determineAssignment(e,i),n=this.calculateDeadline(e,i),r={...e,id:t,createdAt:a,assignedTo:s,deadline:n,updates:[],escalations:[],priority:e.priority||(null==i?void 0:i.defaultPriority)||"medium",status:e.status||"created"};return this.situations.set(t,r),await this.addUpdate(t,{userId:r.createdBy,type:"status_change",content:"Situation created: ".concat(r.title),metadata:{status:"created"}}),await this.notifyAssignedParties(r),r}async updateSituation(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let i={...a,...t};return this.situations.set(e,i),t.status&&t.status!==a.status&&await this.addUpdate(e,{userId:"system",type:"status_change",content:"Status changed from ".concat(a.status," to ").concat(t.status),metadata:{oldStatus:a.status,newStatus:t.status}}),i}async addUpdate(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let i={id:this.generateId(),situationId:e,timestamp:new Date,...t};a.updates.push(i),this.situations.set(e,a)}async resolveSituation(e,t,a){let i=this.situations.get(e);if(!i)throw Error("Situation ".concat(e," not found"));await this.updateSituation(e,{status:"resolved",resolvedAt:new Date}),await this.addUpdate(e,{userId:"system",type:"status_change",content:"Situation resolved: ".concat(t),metadata:{resolution:t,...a}}),i.gamificationImpact&&await this.applyGamificationImpact(i)}async escalateSituation(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let i=a.escalations.length+1,s={id:this.generateId(),situationId:e,level:i,reason:t,triggeredAt:new Date,triggeredBy:"user",actions:this.getEscalationActions(a,i),resolved:!1};a.escalations.push(s),await this.updateSituation(e,{status:"escalated",priority:this.increasePriority(a.priority)}),await this.addUpdate(e,{userId:"system",type:"escalation",content:"Situation escalated (Level ".concat(i,"): ").concat(t),metadata:{escalationLevel:i,reason:t}}),await this.executeEscalationActions(s)}async getSituations(e){let t=Array.from(this.situations.values());return e.relationshipId&&(t=t.filter(t=>t.relationshipId===e.relationshipId)),e.status&&(t=t.filter(t=>e.status.includes(t.status))),e.type&&(t=t.filter(t=>e.type.includes(t.type))),e.assignedTo&&(t=t.filter(t=>t.assignedTo.includes(e.assignedTo))),e.priority&&(t=t.filter(t=>e.priority.includes(t.priority))),t.sort((e,t)=>{let a={urgent:4,high:3,medium:2,low:1},i=a[e.priority],s=a[t.priority];return i!==s?s-i:t.createdAt.getTime()-e.createdAt.getTime()})}getSituation(e){return this.situations.get(e)}getOverdueSituations(){let e=new Date;return Array.from(this.situations.values()).filter(t=>t.deadline&&t.deadline<e&&!["resolved","cancelled"].includes(t.status))}getSituationsRequiringEscalation(){let e=Date.now();return Array.from(this.situations.values()).filter(t=>!["resolved","cancelled"].includes(t.status)&&!t.updates.some(e=>"status_change"===e.type&&e.content.includes("acknowledged"))&&e-t.createdAt.getTime()>("urgent"===t.priority?9e5:72e5))}initializeTemplates(){this.templates.set("emergency-pickup",{id:"emergency-pickup",type:"emergency",name:"Emergency School Pickup",description:"Child needs immediate pickup from school",defaultPriority:"urgent",defaultDeadlineHours:1,requiredFields:["location","emergencyType"],metadataSchema:{emergencyType:"pickup",requiresPickup:!0},autoAssignmentRules:[{condition:"emergency",assignTo:"both"}]}),this.templates.set("forgotten-item",{id:"forgotten-item",type:"logistics",name:"Forgotten Item",description:"Child forgot important item at other parent's house",defaultPriority:"medium",defaultDeadlineHours:24,requiredFields:["items"],metadataSchema:{logisticsType:"forgotten_item"},autoAssignmentRules:[{condition:"logistics",assignTo:"other_parent"}]}),this.templates.set("behavioral-incident",{id:"behavioral-incident",type:"behavioral",name:"Behavioral Incident",description:"Child behavioral issue requiring coordination",defaultPriority:"high",defaultDeadlineHours:48,requiredFields:["incident","childId"],metadataSchema:{behaviorType:"disciplinary",privacyLevel:"both_parents"},autoAssignmentRules:[{condition:"behavioral",assignTo:"both"}]})}getTemplate(e){return Array.from(this.templates.values()).find(t=>t.type===e)}determineAssignment(e,t){if(e.assignedTo&&e.assignedTo.length>0)return e.assignedTo;if(null==t?void 0:t.autoAssignmentRules)switch(t.autoAssignmentRules[0].assignTo){case"both":return e.involvedParties;case"other_parent":return e.involvedParties.filter(t=>t!==e.createdBy)}return[e.createdBy]}calculateDeadline(e,t){if(e.deadline)return e.deadline;if(null==t?void 0:t.defaultDeadlineHours){let e=new Date;return e.setHours(e.getHours()+t.defaultDeadlineHours),e}let a={urgent:2,high:24,medium:72,low:168}[e.priority||"medium"],i=new Date;return i.setHours(i.getHours()+a),i}increasePriority(e){let t=["low","medium","high","urgent"],a=Math.min(t.indexOf(e)+1,t.length-1);return t[a]}getEscalationActions(e,t){let a=[];switch(t){case 1:a.push("send_reminder","notify_assigned_parties");break;case 2:a.push("increase_priority","notify_emergency_contacts");break;case 3:a.push("create_follow_up_situation","notify_external_parties");break;default:a.push("manual_intervention_required")}return a}async executeEscalationActions(e){console.log("Executing escalation actions for situation ".concat(e.situationId,":"),e.actions)}async notifyAssignedParties(e){console.log("Notifying assigned parties for situation ".concat(e.id,":"),e.assignedTo)}async applyGamificationImpact(e){e.gamificationImpact&&console.log("Applying gamification impact for situation ".concat(e.id,":"),e.gamificationImpact)}generateId(){return"sit_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){this.situations=new Map,this.templates=new Map,this.initializeTemplates()}}new i},5705:(e,t,a)=>{a.d(t,{B:()=>u});let i=()=>({currentUser:{id:"demo-user-1",email:"demo.parent1@example.com",full_name:"Alex Johnson",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z",credit_score:100},otherParent:{id:"demo-user-2",email:"demo.parent2@example.com",full_name:"Jordan Smith",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z",credit_score:100}}),s=()=>[{id:"demo-child-1",name:"Emma Johnson-Smith",date_of_birth:"2016-03-15",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-child-2",name:"Liam Johnson-Smith",date_of_birth:"2019-08-22",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],n=(e,t,a)=>({id:"demo-relationship-1",child_id:a,parent_a_id:e,parent_b_id:t,time_ratio:50,preference_ratio:50,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}),r=(e,t,a)=>{let i=[],s=new Date,n=new Date;n.setMonth(n.getMonth()+2);let r=new Date(s),o=t,d=0;for(;r<=n;){d>0&&1===r.getDay()&&(o=o===t?a:t);let s=r.getDay();if(0===s||6===s||o===t&&(1===s||2===s)||o===a&&(4===s||5===s)){let a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),18,0),s=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1,8,0);i.push({id:"demo-event-".concat(i.length+1),schedule_id:e,parent_id:o,start_time:a.toISOString(),end_time:s.toISOString(),title:"Custody Time - ".concat(o===t?"Your":"Co-parent's"," Week"),description:"Regular custody schedule",location:o===t?"Your Home":"Co-parent's Home",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"})}if(11===r.getMonth()&&25===r.getDate()){let t=new Date(r.getFullYear(),r.getMonth(),r.getDate(),9,0),s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),20,0);i.push({id:"demo-event-christmas",schedule_id:e,parent_id:a,start_time:t.toISOString(),end_time:s.toISOString(),title:"Christmas Day",description:"Christmas celebration",location:"Co-parent's Home",created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"})}r.setDate(r.getDate()+1),1===r.getDay()&&d++}return i},o=(e,t)=>({days:[{id:"demo-day-pref-1",relationship_id:e,parent_id:t,day_of_week:5,priority:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-2",relationship_id:e,parent_id:t,day_of_week:6,priority:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-3",relationship_id:e,parent_id:t,day_of_week:0,priority:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-4",relationship_id:e,parent_id:t,day_of_week:3,priority:4,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-5",relationship_id:e,parent_id:t,day_of_week:4,priority:5,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-6",relationship_id:e,parent_id:t,day_of_week:1,priority:6,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-day-pref-7",relationship_id:e,parent_id:t,day_of_week:2,priority:7,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],dates:[{id:"demo-date-pref-1",relationship_id:e,parent_id:t,date:"2025-12-25",priority:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-2",relationship_id:e,parent_id:t,date:"2025-07-04",priority:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-3",relationship_id:e,parent_id:t,date:"2025-11-27",priority:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-date-pref-4",relationship_id:e,parent_id:t,date:"2025-03-15",priority:4,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}],handoffTimes:[{id:"demo-handoff-1",relationship_id:e,time:"18:00",priority_parent_a:1,priority_parent_b:3,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-2",relationship_id:e,time:"12:00",priority_parent_a:2,priority_parent_b:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-3",relationship_id:e,time:"15:00",priority_parent_a:3,priority_parent_b:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-4",relationship_id:e,time:"10:00",priority_parent_a:1,priority_parent_b:2,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"},{id:"demo-handoff-5",relationship_id:e,time:"14:00",priority_parent_a:2,priority_parent_b:1,created_at:"2024-01-15T00:00:00Z",updated_at:"2024-12-01T00:00:00Z"}]}),d=()=>{let{currentUser:e,otherParent:t}=i(),a=s(),d=n(e.id,t.id,a[0].id),c=r("demo-schedule-1",e.id,t.id),l=o(d.id,e.id);return{currentUser:e,otherParent:t,children:a,relationship:d,scheduleEvents:c,preferences:l}},c=()=>({"2025-01-01":"New Year's Day","2025-02-14":"Valentine's Day","2025-03-15":"Emma's Birthday","2025-03-17":"St. Patrick's Day","2025-04-20":"Easter","2025-05-11":"Mother's Day","2025-06-15":"Father's Day","2025-07-04":"Independence Day","2025-08-22":"Liam's Birthday","2025-09-01":"Labor Day","2025-10-31":"Halloween","2025-11-27":"Thanksgiving","2025-12-25":"Christmas Day","2025-12-31":"New Year's Eve"});class l{generateDemoData(){return d()}getGuestData(){return this.currentSession?this.currentSession.demoData:null}getHolidayData(){return c()}saveGuestInteraction(e,t,a){if(this.currentSession||this.loadOrCreateSession(),!this.currentSession)return void console.warn("Failed to create guest session");let i={id:"interaction-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,timestamp:new Date,data:t,metadata:a};this.currentSession.interactions.push(i),this.currentSession.lastActivity=new Date,this.currentSession.interactions.length>100&&(this.currentSession.interactions=this.currentSession.interactions.slice(-50)),this.saveSession()}updateGuestPreferences(e,t){this.currentSession&&(this.currentSession.demoData.preferences[e]=t,this.saveGuestInteraction("preference_sort",{type:e,preferences:t}),this.saveSession())}getSessionAnalytics(){let e;if(!this.currentSession)return{sessionDuration:0,interactionCount:0,featuresUsed:[],sortingCompleted:!1,engagementScore:0};let t=Date.now()-this.currentSession.startTime.getTime(),a=this.currentSession.interactions.length,i=[...new Set(this.currentSession.interactions.map(e=>e.type))],s=this.currentSession.interactions.some(e=>"preference_sort"===e.type);return e=0+30*Math.min(t/3e5,1)+40*Math.min(a/10,1)+5*i.length+20*!!s,{sessionDuration:t,interactionCount:a,featuresUsed:i,sortingCompleted:s,engagementScore:Math.min(e,100)}}exportGuestDataForSignup(){return this.currentSession?{preferences:this.currentSession.demoData.preferences}:null}clearGuestData(){try{localStorage.removeItem(l.STORAGE_KEY),this.currentSession=null}catch(e){console.warn("Failed to clear guest data:",e)}}isGuestMode(){return null!==this.currentSession}getSessionId(){var e;return(null==(e=this.currentSession)?void 0:e.sessionId)||null}updateSessionPreferences(e){this.currentSession&&(this.currentSession.preferences={...this.currentSession.preferences,...e},this.saveSession())}loadOrCreateSession(){try{let e=localStorage.getItem(l.STORAGE_KEY);if(e){let t=JSON.parse(e),a=new Date(t.lastActivity);if(!(Date.now()-a.getTime()>l.SESSION_TIMEOUT)){t.startTime=new Date(t.startTime),t.lastActivity=new Date(t.lastActivity),t.interactions=t.interactions.map(e=>({...e,timestamp:new Date(e.timestamp)})),this.currentSession=t;return}}}catch(e){console.warn("Failed to load guest session:",e)}this.createNewSession()}createNewSession(){let e="guest-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9));this.currentSession={sessionId:e,startTime:new Date,lastActivity:new Date,interactions:[],demoData:this.generateDemoData(),preferences:{completedTutorial:!1,skipTour:!1,preferredFeatures:[]}},this.saveSession()}saveSession(){if(this.currentSession)try{let e=JSON.stringify(this.currentSession);if(e.length>l.MAX_STORAGE_SIZE){console.warn("Guest session data too large, trimming interactions"),this.currentSession.interactions=this.currentSession.interactions.slice(-20),this.saveSession();return}localStorage.setItem(l.STORAGE_KEY,e)}catch(e){e instanceof DOMException&&22===e.code?(console.warn("localStorage quota exceeded, clearing old guest data"),this.clearGuestData(),this.createNewSession()):console.error("Failed to save guest session:",e)}}getConversionReadiness(){let e=this.getSessionAnalytics(),t={timeSpent:25*Math.min(e.sessionDuration/6e5,1),featuresExplored:25*Math.min(e.featuresUsed.length/3,1),sortingCompleted:25*!!e.sortingCompleted,engagementLevel:.25*e.engagementScore},a=Object.values(t).reduce((e,t)=>e+t,0),i=[];return t.timeSpent<15&&i.push("Encourage more exploration"),t.featuresExplored<15&&i.push("Show additional features"),e.sortingCompleted||i.push("Guide to sorting feature"),a>70&&i.push("Show conversion prompt"),{score:a,factors:t,recommendations:i}}constructor(){this.currentSession=null,this.loadOrCreateSession()}}l.STORAGE_KEY="coparent_guest_session",l.MAX_STORAGE_SIZE=5242880,l.SESSION_TIMEOUT=864e5;let u=new l},6695:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>d,Zp:()=>r,aR:()=>o});var i=a(5155),s=a(2115),n=a(9434);let r=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});r.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});o.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});d.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});l.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},7122:(e,t,a)=>{a.d(t,{b:()=>c});var i=a(5155),s=a(2115),n=a(8417),r=a(285),o=a(6695),d=a(5705);function c(e){var t;let{situation:a,currentUserId:c,onResponseSent:l,isGuestMode:u=!1}=e,[m,p]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null),[y,f]=(0,s.useState)(""),[_,v]=(0,s.useState)(""),w=async e=>{if(!m){p(!0),h(e);try{let t={situationId:a.id,userId:c,responseType:e,message:y||void 0,estimatedArrival:_?new Date(_):void 0};if(u){d.B.saveGuestInteraction("demo_action",{type:"emergency_quick_response",situationId:a.id,responseType:e,message:y,source:"quick_response"});let i={id:"qr_".concat(Date.now()),timestamp:new Date,...t};l&&l(i)}else await n.N.sendQuickResponse(a.id,t);f(""),v(""),h(null)}catch(e){console.error("Error sending quick response:",e)}finally{p(!1)}}};return(0,i.jsx)(o.Zp,{className:"border-l-4 border-l-red-500",children:(0,i.jsxs)(o.Wu,{className:"p-6",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["\uD83D\uDEA8 ",a.title]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:[(e=>{let t=Math.floor((new Date().getTime()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let a=Math.floor(t/60);if(a<24)return"".concat(a,"h ago");let i=Math.floor(a/24);return"".concat(i,"d ago")})(a.createdAt)," • ",(null==(t=a.metadata.location)?void 0:t.name)||"Location not specified"]})]})]}),(0,i.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case 5:return"bg-red-600 text-white";case 4:return"bg-red-500 text-white";case 3:return"bg-orange-500 text-white";case 2:return"bg-yellow-500 text-white";case 1:return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}})(a.metadata.urgencyLevel)),children:["Level ",a.metadata.urgencyLevel]})]}),(0,i.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,i.jsx)("p",{className:"text-gray-800 mb-2",children:a.description}),a.metadata.location&&(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,i.jsx)("span",{className:"font-medium",children:"Location:"})," ",a.metadata.location.address]}),a.metadata.requiresPickup&&(0,i.jsx)("div",{className:"text-sm text-orange-600 font-medium mt-1",children:"⚠️ Pickup required"}),a.metadata.requiresMedicalAttention&&(0,i.jsx)("div",{className:"text-sm text-red-600 font-medium mt-1",children:"\uD83C\uDFE5 Medical attention needed"})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900",children:"Quick Response:"}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{type:"acknowledged",label:"Acknowledged",icon:"✓",description:"I see this emergency",color:"bg-blue-100 text-blue-800 hover:bg-blue-200"},{type:"on_way",label:"On My Way",icon:"\uD83D\uDE97",description:"I'm heading there now",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"handled",label:"Handled",icon:"✅",description:"Situation is resolved",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"need_help",label:"Need Help",icon:"\uD83C\uDD98",description:"I need additional assistance",color:"bg-orange-100 text-orange-800 hover:bg-orange-200"},{type:"cant_help",label:"Can't Help",icon:"❌",description:"I'm unable to assist",color:"bg-red-100 text-red-800 hover:bg-red-200"}].map(e=>(0,i.jsxs)(r.$,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2 ".concat(e.color," ").concat(g===e.type?"ring-2 ring-blue-500":""),onClick:()=>w(e.type),disabled:m,children:[(0,i.jsx)("span",{className:"text-2xl",children:e.icon}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"font-medium",children:e.label}),(0,i.jsx)("div",{className:"text-xs opacity-75",children:e.description})]})]},e.type))}),("on_way"===g||"need_help"===g||"cant_help"===g)&&(0,i.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg",children:["on_way"===g&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Arrival Time"}),(0,i.jsx)("input",{type:"datetime-local",value:_,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().slice(0,16)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Message (Optional)"}),(0,i.jsx)("textarea",{value:y,onChange:e=>f(e.target.value),placeholder:"Add any additional details...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]})]}),m&&(0,i.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,i.jsx)("span",{className:"ml-2 text-gray-600",children:"Sending response..."})]})]}),(0,i.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,i.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,i.jsxs)(r.$,{variant:"outline",size:"sm",children:["\uD83D\uDCDE Call ",a.assignedTo[0]||"Parent"]}),(0,i.jsx)(r.$,{variant:"outline",size:"sm",children:"\uD83D\uDCCD Get Directions"}),a.metadata.urgencyLevel>=4&&(0,i.jsx)(r.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:"\uD83D\uDEA8 Call 911"})]})}),u&&(0,i.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,i.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,i.jsx)("span",{className:"font-medium",children:"Demo Mode:"})," In a real emergency, your response would immediately notify all involved parties and update the situation status."]})})]})})}},8417:(e,t,a)=>{a.d(t,{N:()=>n,h:()=>s});var i=a(3382);class s extends i.W{async createEmergency(e){let t={...e,priority:"urgent",status:"created"},a=await this.createSituation(t),i=this.calculateEstimatedResolutionTime(a.metadata.urgencyLevel);return a.metadata={...a.metadata,estimatedResolutionTime:i},await this.sendImmediateNotifications(a),await this.scheduleEmergencyEscalation(a),a}async sendQuickResponse(e,t){let a=this.getSituation(e);if(!a)throw Error("Situation ".concat(e," not found"));let i={id:this.generateId(),timestamp:new Date,...t};this.quickResponses.has(e)||this.quickResponses.set(e,[]),this.quickResponses.get(e).push(i),await this.handleQuickResponseUpdate(a,i),await this.addUpdate(e,{userId:i.userId,type:"comment",content:this.formatQuickResponseMessage(i),metadata:{responseType:i.responseType,estimatedArrival:i.estimatedArrival,location:i.location}}),await this.notifyQuickResponse(a,i)}async trackLocation(e,t,a){this.locationTracking.has(e)||this.locationTracking.set(e,new Map),this.locationTracking.get(e).set(t,a),await this.addUpdate(e,{userId:t,type:"comment",content:"Location updated: ".concat(a[0].toFixed(6),", ").concat(a[1].toFixed(6)),metadata:{location:a,locationType:"gps_update"}})}async escalateToEmergencyContacts(e){let t=this.getSituation(e);if(!t)throw Error("Emergency situation ".concat(e," not found"));let a=t.metadata.emergencyContacts||[];if(0===a.length)return void console.warn("No emergency contacts configured for situation ".concat(e));await this.escalateSituation(e,"No response from assigned parties - escalating to emergency contacts"),await this.notifyEmergencyContacts(t,a),t.metadata.urgencyLevel>=4&&await this.handleHighUrgencyEscalation(t)}async getActiveEmergencies(e){return(await this.getSituations({type:["emergency"],status:["created","acknowledged","in-progress","escalated"]})).filter(t=>t.involvedParties.includes(e)||t.assignedTo.includes(e))}getQuickResponses(e){return this.quickResponses.get(e)||[]}getLocationTracking(e){return this.locationTracking.get(e)||new Map}requiresImmediateEscalation(e){let{urgencyLevel:t,requiresMedicalAttention:a}=e.metadata;return!!(5===t||a&&t>=3||e.deadline&&e.deadline.getTime()-Date.now()<9e5)||!1}calculateEstimatedResolutionTime(e){switch(e){case 5:return 15;case 4:return 30;case 3:default:return 60;case 2:return 120;case 1:return 240}}async sendImmediateNotifications(e){var t;console.log("\uD83D\uDEA8 EMERGENCY NOTIFICATION: ".concat(e.title)),console.log("Assigned to: ".concat(e.assignedTo.join(", "))),console.log("Urgency Level: ".concat(e.metadata.urgencyLevel,"/5")),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.name)||"Not specified"))}async scheduleEmergencyEscalation(e){let t=this.getEscalationDelay(e);console.log("Scheduling emergency escalation for situation ".concat(e.id," in ").concat(t," minutes"))}getEscalationDelay(e){let{urgencyLevel:t}=e.metadata;switch(t){case 5:return 5;case 4:return 10;case 3:default:return 15;case 2:return 30;case 1:return 60}}async handleQuickResponseUpdate(e,t){let a=e.status;switch(t.responseType){case"acknowledged":"created"===e.status&&(a="acknowledged");break;case"on_way":a="in-progress";break;case"handled":a="resolved";break;case"need_help":await this.escalateToEmergencyContacts(e.id);break;case"cant_help":await this.handleCannotHelp(e,t)}a!==e.status&&await this.updateSituation(e.id,{status:a})}formatQuickResponseMessage(e){let t={acknowledged:"Acknowledged the emergency",on_way:"On my way",handled:"Situation handled",need_help:"Need additional help",cant_help:"Cannot help with this emergency"}[e.responseType];return e.estimatedArrival&&(t+=" - ETA: ".concat(e.estimatedArrival.toLocaleTimeString())),e.message&&(t+=" - ".concat(e.message)),t}async notifyQuickResponse(e,t){let a=e.involvedParties.filter(e=>e!==t.userId);console.log("Notifying parties about quick response: ".concat(a.join(", "))),console.log("Response: ".concat(this.formatQuickResponseMessage(t)))}async notifyEmergencyContacts(e,t){console.log("\uD83D\uDEA8 ESCALATING TO EMERGENCY CONTACTS: ".concat(t.join(", "))),console.log("Emergency: ".concat(e.title)),console.log("Urgency: ".concat(e.metadata.urgencyLevel,"/5"))}async handleHighUrgencyEscalation(e){if(5===e.metadata.urgencyLevel){var t;console.log("⚠️  LEVEL 5 EMERGENCY - Consider calling 911"),console.log("Emergency: ".concat(e.title)),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.address)||"Unknown"))}await this.addUpdate(e.id,{userId:"system",type:"escalation",content:"High urgency emergency (Level ".concat(e.metadata.urgencyLevel,") - Additional safety protocols activated"),metadata:{urgencyLevel:e.metadata.urgencyLevel,autoEscalation:!0}})}async handleCannotHelp(e,t){let a=e.involvedParties.filter(a=>a!==t.userId&&!e.assignedTo.includes(a));a.length>0?(await this.updateSituation(e.id,{assignedTo:[...e.assignedTo,...a]}),await this.addUpdate(e.id,{userId:"system",type:"status_change",content:"Reassigned to additional parties: ".concat(a.join(", ")),metadata:{reassignment:!0,originalResponder:t.userId}})):await this.escalateToEmergencyContacts(e.id)}constructor(...e){super(...e),this.quickResponses=new Map,this.locationTracking=new Map}}let n=new s},9434:(e,t,a)=>{a.d(t,{cn:()=>n});var i=a(2596),s=a(9688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,i.$)(t))}}}]);