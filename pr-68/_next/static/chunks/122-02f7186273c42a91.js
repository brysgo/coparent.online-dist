"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{285:(e,t,a)=>{a.d(t,{$:()=>c});var n=a(5155),i=a(2115),s=a(4624),r=a(2085),o=a(9434);let l=(0,r.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,t)=>{let{className:a,variant:i,size:r,asChild:c=!1,...d}=e,u=c?s.DX:"button";return(0,n.jsx)(u,{className:(0,o.cn)(l({variant:i,size:r,className:a})),ref:t,...d})});c.displayName="Button"},2085:(e,t,a)=>{a.d(t,{F:()=>r});var n=a(2596);let i=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=n.$,r=(e,t)=>a=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:r,defaultVariants:o}=t,l=Object.keys(r).map(e=>{let t=null==a?void 0:a[e],n=null==o?void 0:o[e];if(null===t)return null;let s=i(t)||i(n);return r[e][s]}),c=a&&Object.entries(a).reduce((e,t)=>{let[a,n]=t;return void 0===n||(e[a]=n),e},{});return s(e,l,null==t||null==(n=t.compoundVariants)?void 0:n.reduce((e,t)=>{let{class:a,className:n,...i}=t;return Object.entries(i).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...o,...c}[t]):({...o,...c})[t]===a})?[...e,a,n]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},3382:(e,t,a)=>{a.d(t,{W:()=>n});class n{async createSituation(e){let t=this.generateId(),a=new Date,n=this.getTemplate(e.type),i=this.determineAssignment(e,n),s=this.calculateDeadline(e,n),r={...e,id:t,createdAt:a,assignedTo:i,deadline:s,updates:[],escalations:[],priority:e.priority||(null==n?void 0:n.defaultPriority)||"medium",status:e.status||"created"};return this.situations.set(t,r),await this.addUpdate(t,{userId:r.createdBy,type:"status_change",content:"Situation created: ".concat(r.title),metadata:{status:"created"}}),await this.notifyAssignedParties(r),r}async updateSituation(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let n={...a,...t};return this.situations.set(e,n),t.status&&t.status!==a.status&&await this.addUpdate(e,{userId:"system",type:"status_change",content:"Status changed from ".concat(a.status," to ").concat(t.status),metadata:{oldStatus:a.status,newStatus:t.status}}),n}async addUpdate(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let n={id:this.generateId(),situationId:e,timestamp:new Date,...t};a.updates.push(n),this.situations.set(e,a)}async resolveSituation(e,t,a){let n=this.situations.get(e);if(!n)throw Error("Situation ".concat(e," not found"));await this.updateSituation(e,{status:"resolved",resolvedAt:new Date}),await this.addUpdate(e,{userId:"system",type:"status_change",content:"Situation resolved: ".concat(t),metadata:{resolution:t,...a}}),n.gamificationImpact&&await this.applyGamificationImpact(n)}async escalateSituation(e,t){let a=this.situations.get(e);if(!a)throw Error("Situation ".concat(e," not found"));let n=a.escalations.length+1,i={id:this.generateId(),situationId:e,level:n,reason:t,triggeredAt:new Date,triggeredBy:"user",actions:this.getEscalationActions(a,n),resolved:!1};a.escalations.push(i),await this.updateSituation(e,{status:"escalated",priority:this.increasePriority(a.priority)}),await this.addUpdate(e,{userId:"system",type:"escalation",content:"Situation escalated (Level ".concat(n,"): ").concat(t),metadata:{escalationLevel:n,reason:t}}),await this.executeEscalationActions(i)}async getSituations(e){let t=Array.from(this.situations.values());return e.relationshipId&&(t=t.filter(t=>t.relationshipId===e.relationshipId)),e.status&&(t=t.filter(t=>e.status.includes(t.status))),e.type&&(t=t.filter(t=>e.type.includes(t.type))),e.assignedTo&&(t=t.filter(t=>t.assignedTo.includes(e.assignedTo))),e.priority&&(t=t.filter(t=>e.priority.includes(t.priority))),t.sort((e,t)=>{let a={urgent:4,high:3,medium:2,low:1},n=a[e.priority],i=a[t.priority];return n!==i?i-n:t.createdAt.getTime()-e.createdAt.getTime()})}getSituation(e){return this.situations.get(e)}getOverdueSituations(){let e=new Date;return Array.from(this.situations.values()).filter(t=>t.deadline&&t.deadline<e&&!["resolved","cancelled"].includes(t.status))}getSituationsRequiringEscalation(){let e=Date.now();return Array.from(this.situations.values()).filter(t=>!["resolved","cancelled"].includes(t.status)&&!t.updates.some(e=>"status_change"===e.type&&e.content.includes("acknowledged"))&&e-t.createdAt.getTime()>("urgent"===t.priority?9e5:72e5))}initializeTemplates(){this.templates.set("emergency-pickup",{id:"emergency-pickup",type:"emergency",name:"Emergency School Pickup",description:"Child needs immediate pickup from school",defaultPriority:"urgent",defaultDeadlineHours:1,requiredFields:["location","emergencyType"],metadataSchema:{emergencyType:"pickup",requiresPickup:!0},autoAssignmentRules:[{condition:"emergency",assignTo:"both"}]}),this.templates.set("forgotten-item",{id:"forgotten-item",type:"logistics",name:"Forgotten Item",description:"Child forgot important item at other parent's house",defaultPriority:"medium",defaultDeadlineHours:24,requiredFields:["items"],metadataSchema:{logisticsType:"forgotten_item"},autoAssignmentRules:[{condition:"logistics",assignTo:"other_parent"}]}),this.templates.set("behavioral-incident",{id:"behavioral-incident",type:"behavioral",name:"Behavioral Incident",description:"Child behavioral issue requiring coordination",defaultPriority:"high",defaultDeadlineHours:48,requiredFields:["incident","childId"],metadataSchema:{behaviorType:"disciplinary",privacyLevel:"both_parents"},autoAssignmentRules:[{condition:"behavioral",assignTo:"both"}]})}getTemplate(e){return Array.from(this.templates.values()).find(t=>t.type===e)}determineAssignment(e,t){if(e.assignedTo&&e.assignedTo.length>0)return e.assignedTo;if(null==t?void 0:t.autoAssignmentRules)switch(t.autoAssignmentRules[0].assignTo){case"both":return e.involvedParties;case"other_parent":return e.involvedParties.filter(t=>t!==e.createdBy)}return[e.createdBy]}calculateDeadline(e,t){if(e.deadline)return e.deadline;if(null==t?void 0:t.defaultDeadlineHours){let e=new Date;return e.setHours(e.getHours()+t.defaultDeadlineHours),e}let a={urgent:2,high:24,medium:72,low:168}[e.priority||"medium"],n=new Date;return n.setHours(n.getHours()+a),n}increasePriority(e){let t=["low","medium","high","urgent"],a=Math.min(t.indexOf(e)+1,t.length-1);return t[a]}getEscalationActions(e,t){let a=[];switch(t){case 1:a.push("send_reminder","notify_assigned_parties");break;case 2:a.push("increase_priority","notify_emergency_contacts");break;case 3:a.push("create_follow_up_situation","notify_external_parties");break;default:a.push("manual_intervention_required")}return a}async executeEscalationActions(e){console.log("Executing escalation actions for situation ".concat(e.situationId,":"),e.actions)}async notifyAssignedParties(e){console.log("Notifying assigned parties for situation ".concat(e.id,":"),e.assignedTo)}async applyGamificationImpact(e){e.gamificationImpact&&console.log("Applying gamification impact for situation ".concat(e.id,":"),e.gamificationImpact)}generateId(){return"sit_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){this.situations=new Map,this.templates=new Map,this.initializeTemplates()}}new n},4624:(e,t,a)=>{a.d(t,{DX:()=>r});var n=a(2115);function i(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var s=a(5155),r=function(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:a,...s}=e;if(n.isValidElement(a)){var r;let e,o,l=(r=a,(o=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.ref:(o=(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.props.ref:r.props.ref||r.ref),c=function(e,t){let a={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?a[n]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(a[n]=i):"style"===n?a[n]={...i,...s}:"className"===n&&(a[n]=[i,s].filter(Boolean).join(" "))}return{...e,...a}}(s,a.props);return a.type!==n.Fragment&&(c.ref=t?function(...e){return t=>{let a=!1,n=e.map(e=>{let n=i(e,t);return a||"function"!=typeof n||(a=!0),n});if(a)return()=>{for(let t=0;t<n.length;t++){let a=n[t];"function"==typeof a?a():i(e[t],null)}}}}(t,l):l),n.cloneElement(a,c)}return n.Children.count(a)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),a=n.forwardRef((e,a)=>{let{children:i,...r}=e,o=n.Children.toArray(i),c=o.find(l);if(c){let e=c.props.children,i=o.map(t=>t!==c?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...r,ref:a,children:n.isValidElement(e)?n.cloneElement(e,void 0,i):null})}return(0,s.jsx)(t,{...r,ref:a,children:i})});return a.displayName=`${e}.Slot`,a}("Slot"),o=Symbol("radix.slottable");function l(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},6695:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>r,aR:()=>o});var n=a(5155),i=a(2115),s=a(9434);let r=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...i})});r.displayName="Card";let o=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...i})});o.displayName="CardHeader";let l=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...i})});l.displayName="CardTitle";let c=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...i})});c.displayName="CardDescription";let d=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...i})});d.displayName="CardContent",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...i})}).displayName="CardFooter"},7122:(e,t,a)=>{a.d(t,{b:()=>c});var n=a(5155),i=a(2115),s=a(8417),r=a(285),o=a(6695),l=a(5705);function c(e){var t;let{situation:a,currentUserId:c,onResponseSent:d,isGuestMode:u=!1}=e,[m,g]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[y,f]=(0,i.useState)(""),[v,x]=(0,i.useState)(""),w=async e=>{if(!m){g(!0),h(e);try{let t={situationId:a.id,userId:c,responseType:e,message:y||void 0,estimatedArrival:v?new Date(v):void 0};if(u){l.guestModeManager.saveGuestInteraction("demo_action",{type:"emergency_quick_response",situationId:a.id,responseType:e,message:y,source:"quick_response"});let n={id:"qr_".concat(Date.now()),timestamp:new Date,...t};d&&d(n)}else await s.N.sendQuickResponse(a.id,t);f(""),x(""),h(null)}catch(e){console.error("Error sending quick response:",e)}finally{g(!1)}}};return(0,n.jsx)(o.Zp,{className:"border-l-4 border-l-red-500",children:(0,n.jsxs)(o.Wu,{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["\uD83D\uDEA8 ",a.title]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[(e=>{let t=Math.floor((new Date().getTime()-e.getTime())/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let a=Math.floor(t/60);if(a<24)return"".concat(a,"h ago");let n=Math.floor(a/24);return"".concat(n,"d ago")})(a.createdAt)," • ",(null==(t=a.metadata.location)?void 0:t.name)||"Location not specified"]})]})]}),(0,n.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case 5:return"bg-red-600 text-white";case 4:return"bg-red-500 text-white";case 3:return"bg-orange-500 text-white";case 2:return"bg-yellow-500 text-white";case 1:return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}})(a.metadata.urgencyLevel)),children:["Level ",a.metadata.urgencyLevel]})]}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,n.jsx)("p",{className:"text-gray-800 mb-2",children:a.description}),a.metadata.location&&(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium",children:"Location:"})," ",a.metadata.location.address]}),a.metadata.requiresPickup&&(0,n.jsx)("div",{className:"text-sm text-orange-600 font-medium mt-1",children:"⚠️ Pickup required"}),a.metadata.requiresMedicalAttention&&(0,n.jsx)("div",{className:"text-sm text-red-600 font-medium mt-1",children:"\uD83C\uDFE5 Medical attention needed"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:"Quick Response:"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{type:"acknowledged",label:"Acknowledged",icon:"✓",description:"I see this emergency",color:"bg-blue-100 text-blue-800 hover:bg-blue-200"},{type:"on_way",label:"On My Way",icon:"\uD83D\uDE97",description:"I'm heading there now",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"handled",label:"Handled",icon:"✅",description:"Situation is resolved",color:"bg-green-100 text-green-800 hover:bg-green-200"},{type:"need_help",label:"Need Help",icon:"\uD83C\uDD98",description:"I need additional assistance",color:"bg-orange-100 text-orange-800 hover:bg-orange-200"},{type:"cant_help",label:"Can't Help",icon:"❌",description:"I'm unable to assist",color:"bg-red-100 text-red-800 hover:bg-red-200"}].map(e=>(0,n.jsxs)(r.$,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2 ".concat(e.color," ").concat(p===e.type?"ring-2 ring-blue-500":""),onClick:()=>w(e.type),disabled:m,children:[(0,n.jsx)("span",{className:"text-2xl",children:e.icon}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"font-medium",children:e.label}),(0,n.jsx)("div",{className:"text-xs opacity-75",children:e.description})]})]},e.type))}),("on_way"===p||"need_help"===p||"cant_help"===p)&&(0,n.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg",children:["on_way"===p&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Arrival Time"}),(0,n.jsx)("input",{type:"datetime-local",value:v,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().slice(0,16)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Message (Optional)"}),(0,n.jsx)("textarea",{value:y,onChange:e=>f(e.target.value),placeholder:"Add any additional details...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2})]})]}),m&&(0,n.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Sending response..."})]})]}),(0,n.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,n.jsxs)(r.$,{variant:"outline",size:"sm",children:["\uD83D\uDCDE Call ",a.assignedTo[0]||"Parent"]}),(0,n.jsx)(r.$,{variant:"outline",size:"sm",children:"\uD83D\uDCCD Get Directions"}),a.metadata.urgencyLevel>=4&&(0,n.jsx)(r.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-50",children:"\uD83D\uDEA8 Call 911"})]})}),u&&(0,n.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,n.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,n.jsx)("span",{className:"font-medium",children:"Demo Mode:"})," In a real emergency, your response would immediately notify all involved parties and update the situation status."]})})]})})}},8417:(e,t,a)=>{a.d(t,{N:()=>s,h:()=>i});var n=a(3382);class i extends n.W{async createEmergency(e){let t={...e,priority:"urgent",status:"created"},a=await this.createSituation(t),n=this.calculateEstimatedResolutionTime(a.metadata.urgencyLevel);return a.metadata={...a.metadata,estimatedResolutionTime:n},await this.sendImmediateNotifications(a),await this.scheduleEmergencyEscalation(a),a}async sendQuickResponse(e,t){let a=this.getSituation(e);if(!a)throw Error("Situation ".concat(e," not found"));let n={id:this.generateId(),timestamp:new Date,...t};this.quickResponses.has(e)||this.quickResponses.set(e,[]),this.quickResponses.get(e).push(n),await this.handleQuickResponseUpdate(a,n),await this.addUpdate(e,{userId:n.userId,type:"comment",content:this.formatQuickResponseMessage(n),metadata:{responseType:n.responseType,estimatedArrival:n.estimatedArrival,location:n.location}}),await this.notifyQuickResponse(a,n)}async trackLocation(e,t,a){this.locationTracking.has(e)||this.locationTracking.set(e,new Map),this.locationTracking.get(e).set(t,a),await this.addUpdate(e,{userId:t,type:"comment",content:"Location updated: ".concat(a[0].toFixed(6),", ").concat(a[1].toFixed(6)),metadata:{location:a,locationType:"gps_update"}})}async escalateToEmergencyContacts(e){let t=this.getSituation(e);if(!t)throw Error("Emergency situation ".concat(e," not found"));let a=t.metadata.emergencyContacts||[];if(0===a.length)return void console.warn("No emergency contacts configured for situation ".concat(e));await this.escalateSituation(e,"No response from assigned parties - escalating to emergency contacts"),await this.notifyEmergencyContacts(t,a),t.metadata.urgencyLevel>=4&&await this.handleHighUrgencyEscalation(t)}async getActiveEmergencies(e){return(await this.getSituations({type:["emergency"],status:["created","acknowledged","in-progress","escalated"]})).filter(t=>t.involvedParties.includes(e)||t.assignedTo.includes(e))}getQuickResponses(e){return this.quickResponses.get(e)||[]}getLocationTracking(e){return this.locationTracking.get(e)||new Map}requiresImmediateEscalation(e){let{urgencyLevel:t,requiresMedicalAttention:a}=e.metadata;return!!(5===t||a&&t>=3||e.deadline&&e.deadline.getTime()-Date.now()<9e5)||!1}calculateEstimatedResolutionTime(e){switch(e){case 5:return 15;case 4:return 30;case 3:default:return 60;case 2:return 120;case 1:return 240}}async sendImmediateNotifications(e){var t;console.log("\uD83D\uDEA8 EMERGENCY NOTIFICATION: ".concat(e.title)),console.log("Assigned to: ".concat(e.assignedTo.join(", "))),console.log("Urgency Level: ".concat(e.metadata.urgencyLevel,"/5")),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.name)||"Not specified"))}async scheduleEmergencyEscalation(e){let t=this.getEscalationDelay(e);console.log("Scheduling emergency escalation for situation ".concat(e.id," in ").concat(t," minutes"))}getEscalationDelay(e){let{urgencyLevel:t}=e.metadata;switch(t){case 5:return 5;case 4:return 10;case 3:default:return 15;case 2:return 30;case 1:return 60}}async handleQuickResponseUpdate(e,t){let a=e.status;switch(t.responseType){case"acknowledged":"created"===e.status&&(a="acknowledged");break;case"on_way":a="in-progress";break;case"handled":a="resolved";break;case"need_help":await this.escalateToEmergencyContacts(e.id);break;case"cant_help":await this.handleCannotHelp(e,t)}a!==e.status&&await this.updateSituation(e.id,{status:a})}formatQuickResponseMessage(e){let t={acknowledged:"Acknowledged the emergency",on_way:"On my way",handled:"Situation handled",need_help:"Need additional help",cant_help:"Cannot help with this emergency"}[e.responseType];return e.estimatedArrival&&(t+=" - ETA: ".concat(e.estimatedArrival.toLocaleTimeString())),e.message&&(t+=" - ".concat(e.message)),t}async notifyQuickResponse(e,t){let a=e.involvedParties.filter(e=>e!==t.userId);console.log("Notifying parties about quick response: ".concat(a.join(", "))),console.log("Response: ".concat(this.formatQuickResponseMessage(t)))}async notifyEmergencyContacts(e,t){console.log("\uD83D\uDEA8 ESCALATING TO EMERGENCY CONTACTS: ".concat(t.join(", "))),console.log("Emergency: ".concat(e.title)),console.log("Urgency: ".concat(e.metadata.urgencyLevel,"/5"))}async handleHighUrgencyEscalation(e){if(5===e.metadata.urgencyLevel){var t;console.log("⚠️  LEVEL 5 EMERGENCY - Consider calling 911"),console.log("Emergency: ".concat(e.title)),console.log("Location: ".concat((null==(t=e.metadata.location)?void 0:t.address)||"Unknown"))}await this.addUpdate(e.id,{userId:"system",type:"escalation",content:"High urgency emergency (Level ".concat(e.metadata.urgencyLevel,") - Additional safety protocols activated"),metadata:{urgencyLevel:e.metadata.urgencyLevel,autoEscalation:!0}})}async handleCannotHelp(e,t){let a=e.involvedParties.filter(a=>a!==t.userId&&!e.assignedTo.includes(a));a.length>0?(await this.updateSituation(e.id,{assignedTo:[...e.assignedTo,...a]}),await this.addUpdate(e.id,{userId:"system",type:"status_change",content:"Reassigned to additional parties: ".concat(a.join(", ")),metadata:{reassignment:!0,originalResponder:t.userId}})):await this.escalateToEmergencyContacts(e.id)}constructor(...e){super(...e),this.quickResponses=new Map,this.locationTracking=new Map}}let s=new i},9434:(e,t,a)=>{a.d(t,{Fd:()=>l,Uj:()=>r,cn:()=>s,wz:()=>o});var n=a(2596),i=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,i.QP)((0,n.$)(t))}function r(e){let t=e.startsWith("/")?"".concat("/pr-68").concat(e):e;window.location.href=t}function o(e,t){return e===t||("/"===t?"/"===e:e.startsWith(t+"/")||e===t)}function l(e){return e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?e:"/".concat(e):"/"}}}]);